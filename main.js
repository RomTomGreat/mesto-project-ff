(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",n),e.addEventListener("click",r)}function n(e){"Escape"===e.key&&o(document.querySelector(".popup_is-opened"))}function r(e){(e.currentTarget===e.target||e.target.classList.contains("popup__close"))&&o(e.currentTarget)}function o(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",n),e.removeEventListener("click",r)}function a(e,t,n,r,o){var a=P.querySelector(".card").cloneNode(!0);a.id=e._id;var c=a.querySelector(".card__image");c.src=e.link,c.alt=e.name;var i=a.querySelector(".card__delete-button");a.querySelector(".card__description").querySelector(".card__title").textContent=e.name;var u=e.likes,l=a.querySelector(".card__counter"),s=a.querySelector(".card__like-button");function d(){a.remove()}e.owner._id!==o&&(i.style.visibility="hidden");var p=function(){return u.some((function(e){return e._id===o}))},f=function(e){u=e,m()},m=function(){p()?s.classList.add("card__like-button_is-active"):s.classList.remove("card__like-button_is-active"),l.textContent=u.length};return m(),s.addEventListener("click",(function(){return t(e._id,p(),f)})),i.addEventListener("click",(function(){return n(e._id,d)})),c.addEventListener("click",(function(){return r(e)})),a}e.d({},{O:()=>P});var c=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""},i=function(e,t){e.classList.add(t.inactiveButtonClass),e.disabled=!0},u=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):i(t,n)},l=function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);n.forEach((function(t,n){c(e,t,n)})),i(r,t)},s={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"bb1fee31-957c-4b3e-9d5c-e5a39df6a8a4","Content-Type":"application/json"}};function d(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=document.querySelector(".popup_type_edit");f.classList.add("popup_is-animated");var m=document.querySelector(".popup_type_new-card");m.classList.add("popup_is-animated");var _=document.querySelector(".popup_type_avatar");_.classList.add("popup_is-animated");var v=document.querySelector(".popup_type_image");v.classList.add("popup_is-animated");var y=document.querySelector(".profile__title"),h=document.querySelector(".profile__description"),b=document.querySelector(".profile__avatar"),S=document.querySelector(".profile__edit-button"),q=document.querySelector(".profile__add-button"),g=document.querySelector(".profile__avatar-button"),E=document.querySelector(".popup__image"),L=document.querySelector(".popup__caption"),C="",k=document.forms["edit-profile"],A=document.querySelector(".popup__input_type_name"),x=document.querySelector(".popup__input_type_description"),O=document.forms["new-place"],T=document.querySelector(".popup__input_type_card-name"),w=document.querySelector(".popup__input_type_url"),j=document.forms["edit-avatar"],U=document.querySelector(".popup__input_type_avatar"),P=document.querySelector("#card-template").content,B=document.querySelector(".places__list"),D={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function I(e,t){e.textContent=t}function M(e,t,n){(function(e,t){return fetch("".concat(s.baseUrl,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:s.headers}).then(d)})(e,t).then((function(e){n(e.likes)})).catch((function(e){console.log(e)}))}function N(e,t){var n;(n=e,fetch("".concat(s.baseUrl,"/cards/").concat(n),{method:"DELETE",headers:s.headers}).then(d)).then((function(){t()})).catch((function(e){console.log(e)}))}function J(e){E.src=e.link,E.alt=e.name,L.textContent=e.name,t(v)}Promise.all([fetch("".concat(s.baseUrl,"/cards"),{method:"GET",headers:s.headers}).then(d),fetch("".concat(s.baseUrl,"/users/me"),{method:"GET",headers:s.headers}).then(d)]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,i=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],c=r[1];C=c._id,y.textContent=c.name,h.textContent=c.about,b.style.backgroundImage="url(".concat(c.avatar,")"),o.forEach((function(e){B.append(a(e,M,N,J,C))}))})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);u(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?c(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,o,t),u(n,r,t)}))}))}(t,e)}))}(D),k.addEventListener("submit",(function(e){var t,n;I(e.submitter,"Сохранение..."),e.preventDefault(),(t=A.value,n=x.value,fetch("".concat(s.baseUrl,"/users/me"),{method:"PATCH",headers:s.headers,body:JSON.stringify({name:t,about:n})}).then(d)).then((function(t){y.textContent=t.name,h.textContent=t.about,e.target.reset(),o(f)})).catch((function(e){console.log(e)})).finally((function(){return I(e.submitter,"Сохранить")}))})),O.addEventListener("submit",(function(e){var t;I(e.submitter,"Сохранение..."),e.preventDefault(),(t={name:T.value,link:w.value},fetch("".concat(s.baseUrl,"/cards"),{method:"POST",headers:s.headers,body:JSON.stringify(t)}).then(d)).then((function(t){var n=a(t,M,N,J,C);T.value="",w.value="",B.prepend(n),e.target.reset(),o(m)})).catch((function(e){console.log(e)})).finally((function(){return I(e.submitter,"Сохранить")}))})),j.addEventListener("submit",(function(e){var t;I(e.submitter,"Сохранение..."),e.preventDefault(),(t={avatar:U.value},fetch("".concat(s.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:s.headers,body:JSON.stringify(t)}).then(d)).then((function(e){b.style="background-image: url(".concat(e.avatar,")"),o(_)})).catch((function(e){console.log(e)})).finally((function(){return I(e.submitter,"Сохранить")}))})),S.addEventListener("click",(function(){t(f),A.value=y.textContent,x.value=h.textContent,l(f,D)})),q.addEventListener("click",(function(){t(m),l(m,D)})),g.addEventListener("click",(function(){l(_,D),t(_),U.value=""}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUNnQ2QsQ0FBRVksT0FBUXhCLEVBQWdCd0MsT0QvQmxDaEMsTUFBTSxHQUFEM0QsT0FBSW9CLEVBQU9DLFFBQU8sb0JBQW9CLENBQ2hEdUMsT0FBUSxRQUNSdEMsUUFBU0YsRUFBT0UsUUFDaEJzRSxLQUFNQyxLQUFLQyxVQUFVL0IsS0FFdEJGLEtBQUtyQyxJQzJCTHFDLE1BQUssU0FBQ0UsR0FDTDFCLEVBQWNuRCxNQUFRLHlCQUFIYyxPQUE0QitELEVBQUtZLE9BQU0sS0FDMUR2SCxFQUFXNkUsRUFDYixJQUNDK0IsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixFQUNkLElBQ0MrQixTQUFRLGtCQUFNekMsRUFBVStCLEVBQUlHLFVBQVcsWUFBWSxHQUN0RCxJQW9FQW5ELEVBQWtCdEYsaUJBQWlCLFNBdkNuQyxXQUNFTCxFQUFVb0YsR0FDVmMsRUFBaUI4QyxNQUFReEQsRUFBYXZELFlBQ3RDa0UsRUFBd0I2QyxNQUFTdkQsRUFBbUJ4RCxZQUNwRGdDLEVBQWdCbUIsRUFBZWpDLEVBQ2pDLElBbUNBeUMsRUFBaUJ2RixpQkFBaUIsU0FqQ2xDLFdBQ0VMLEVBQVVxRixHQUNWcEIsRUFBZ0JvQixFQUFrQmxDLEVBQ3BDLElBK0JBMEMsRUFBb0J4RixpQkFBaUIsU0E3QnJDLFdBQ0U0RCxFQUFnQnFCLEVBQWlCbkMsR0FDakNuRCxFQUFVc0YsR0FDVmtCLEVBQWdCd0MsTUFBUSxFQUMxQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veWFuZGV4LXByYWt0aWt1bS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8veWFuZGV4LXByYWt0aWt1bS8uL3NyYy9jb21wb25lbnRzL21vZGFscy5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvY2FyZC5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvYXBpLmpzIiwid2VicGFjazovL3lhbmRleC1wcmFrdGlrdW0vLi9zcmMvY29tcG9uZW50cy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cCkge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9pcy1vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VFc2NQb3B1cCk7XHJcbiAgcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsb3NlTW9kYWxXaW5kb3dPdmVybGF5Q2xpY2spO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZUVzY1BvcHVwKGV2ZW50KSB7XHJcbiAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY2xvc2VQb3B1cChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfaXMtb3BlbmVkJykpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2xvc2VNb2RhbFdpbmRvd092ZXJsYXlDbGljayhldmVudCkge1xyXG4gIGlmIChldmVudC5jdXJyZW50VGFyZ2V0ID09PSBldmVudC50YXJnZXQgfHwgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlJykpIHtcclxuICAgIGNsb3NlUG9wdXAoZXZlbnQuY3VycmVudFRhcmdldCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwKSB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfaXMtb3BlbmVkJyk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VFc2NQb3B1cCk7XHJcbiAgcG9wdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsb3NlTW9kYWxXaW5kb3dPdmVybGF5Q2xpY2spO1xyXG59XHJcblxyXG5leHBvcnQge29wZW5Qb3B1cCwgY2xvc2VQb3B1cH07IiwiaW1wb3J0IHtjYXJkVGVtcGxhdGV9IGZyb20gJy4vaW5kZXgnO1xyXG4vLyDQpNGD0L3QutGG0LjRjyDRgdC+0LfQtNCw0L3QuNGPINC60LDRgNGC0L7Rh9C60LggLy9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSwgcHJlc3NMaWtlLCBkZWxldGVDYXJkcywgc2hvd0NhcmQsIHVzZXJJZCkge1xyXG5cclxuICBjb25zdCBjYXJkID0gY2FyZFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJykuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNhcmQuaWQgPSBpdGVtLl9pZDtcclxuICBcclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xyXG4gIGNhcmRJbWFnZS5zcmMgPSBpdGVtLmxpbms7XHJcbiAgY2FyZEltYWdlLmFsdCA9IGl0ZW0ubmFtZTtcclxuICBcclxuICBjb25zdCBjYXJkRGVsZXRlID0gY2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpO1xyXG4gIGNvbnN0IGNhcmRGb290ZXJDb250YWluZXIgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZXNjcmlwdGlvbicpO1xyXG4gIFxyXG4gIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRGb290ZXJDb250YWluZXIucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJyk7XHJcbiAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gaXRlbS5uYW1lO1xyXG4gIFxyXG4gIGxldCBsaWtlcyA9IGl0ZW0ubGlrZXM7XHJcblxyXG4gIGNvbnN0IGNhcmRDb3VudGVyID0gY2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fY291bnRlcicpO1xyXG4gIGNvbnN0IGNhcmRMaWtlID0gY2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICBcclxuICBmdW5jdGlvbiBkZWxldGVDYXJkKCkge1xyXG4gICAgY2FyZC5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNoZWNrRGVsZXRlSWNvbigpIHtcclxuICAgIGlmIChpdGVtLm93bmVyLl9pZCAhPT0gdXNlcklkKSB7XHJcbiAgICAgIGNhcmREZWxldGUuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNoZWNrRGVsZXRlSWNvbigpO1xyXG5cclxuICAvLyDQv9GA0L7QstC10YDRj9C10Lwg0LvQsNC50LrQvdGD0LvQuCDQu9C4INC80Ysg0LrQsNGA0YLQvtGH0LrRg1xyXG4gIGNvbnN0IGNoZWNrTGlrZSA9ICgpID0+IHtcclxuICAgIHJldHVybiBsaWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdXNlcklkKTtcclxuICB9O1xyXG4gIC8vINC+0LHQvdC+0LLQu9GP0LXRgiDRgtC10LrRg9GJ0LjQuSDQvNCw0YHRgdC40LIg0LvQsNC50LrQvtCyINC4INC+0LHQvdC+0LLQu9GP0LXRgiDRgdGC0LDRgtGD0YFcclxuICBjb25zdCBjaGFuZ2VMaWtlID0gKG5ld0xpa2VzKSA9PiB7XHJcbiAgICBsaWtlcyA9IG5ld0xpa2VzO1xyXG4gICAgc2V0TGlrZVN0YXR1cygpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHNldExpa2VTdGF0dXMgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBpc0xpa2VkID0gY2hlY2tMaWtlKCk7XHJcbiAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICBjYXJkTGlrZS5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhcmRMaWtlLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG4gICAgfVxyXG4gICAgY2FyZENvdW50ZXIudGV4dENvbnRlbnQgPSBsaWtlcy5sZW5ndGg7XHJcbiAgfTtcclxuICBzZXRMaWtlU3RhdHVzKCk7XHJcblxyXG4gIGNhcmRMaWtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBwcmVzc0xpa2UoaXRlbS5faWQsIGNoZWNrTGlrZSgpLCBjaGFuZ2VMaWtlKSk7XHJcbiAgY2FyZERlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gZGVsZXRlQ2FyZHMoaXRlbS5faWQsIGRlbGV0ZUNhcmQpKTtcclxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHNob3dDYXJkKGl0ZW0pKTtcclxuXHJcbiAgcmV0dXJuIGNhcmQ7XHJcbn0iLCJjb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodmFsaWRhdGlvbkNvbmZpZy5lcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxufTtcclxuICBcclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yTWVzc2FnZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eShcIlwiKTtcclxuICB9XHJcblxyXG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9XHJcbn07XHJcbiAgXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuICBcclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufVxyXG5cclxuY29uc3QgZGlzYWJsZWRCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG59XHJcbiAgXHJcbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZWRCdXR0b24oYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxufVxyXG4gIFxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfSlcclxufVxyXG4gIFxyXG5jb25zdCBjbGVhclZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih2YWxpZGF0aW9uQ29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0pO1xyXG4gIGRpc2FibGVkQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xyXG59O1xyXG4gIFxyXG5leHBvcnQge2VuYWJsZVZhbGlkYXRpb24sIGNsZWFyVmFsaWRhdGlvbn07IiwiY29uc3QgY29uZmlnID0ge1xyXG4gIGJhc2VVcmw6ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJyxcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiAnYmIxZmVlMzEtOTU3Yy00YjNlLTlkNWMtZTVhMzlkZjZhOGE0JyxcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFJlc3BvbnNlRGF0YShyZXN1bHQpIHtcclxuICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRVc2VyRGF0YSA9ICgpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgbWV0aG9kOiAnR0VUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuICAudGhlbihnZXRSZXNwb25zZURhdGEpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuICB9KVxyXG4gIC50aGVuKGdldFJlc3BvbnNlRGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0TXlQcm9maWxlID0gKGlucHV0TmFtZSwgaW5wdXREZXNjcmlwdGlvbikgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZTogaW5wdXROYW1lLFxyXG4gICAgICBhYm91dDogaW5wdXREZXNjcmlwdGlvblxyXG4gICAgfSlcclxuICB9KVxyXG4gIC50aGVuKGdldFJlc3BvbnNlRGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVDYXJkTmV3ID0gKGRhdGEpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXHJcbiAgfSlcclxuICAudGhlbihnZXRSZXNwb25zZURhdGEpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY2xpY2tPbkxpa2UgPSAoaWQsIGlzTGlrZWQpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgbWV0aG9kOiBpc0xpa2VkID8gJ0RFTEVURScgOiAnUFVUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuICAudGhlbihnZXRSZXNwb25zZURhdGEpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlTXlDYXJkID0gKGRhdGEpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzLyR7ZGF0YX1gLCB7XHJcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuICB9KVxyXG4gIC50aGVuKGdldFJlc3BvbnNlRGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGVNeUF2YXRhciA9IChkYXRhKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXHJcbiAgfSlcclxuICAudGhlbihnZXRSZXNwb25zZURhdGEpO1xyXG59IiwiaW1wb3J0ICcuLi9wYWdlcy9pbmRleC5jc3MnO1xyXG5pbXBvcnQge29wZW5Qb3B1cCwgY2xvc2VQb3B1cH0gZnJvbSAnLi9tb2RhbHMnO1xyXG5pbXBvcnQge2NyZWF0ZUNhcmR9IGZyb20gJy4vY2FyZCc7XHJcbmltcG9ydCB7ZW5hYmxlVmFsaWRhdGlvbiwgY2xlYXJWYWxpZGF0aW9ufSBmcm9tICcuL3ZhbGlkYXRpb24nO1xyXG5pbXBvcnQge2dldFVzZXJEYXRhLCBnZXRJbml0aWFsQ2FyZHMsIGVkaXRNeVByb2ZpbGUsIGNyZWF0ZUNhcmROZXcsIGNsaWNrT25MaWtlLCBkZWxldGVNeUNhcmQsIHVwZGF0ZU15QXZhdGFyfSBmcm9tICcuL2FwaSc7XHJcblxyXG5jb25zdCBwb3B1cFR5cGVFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdCcpO1xyXG5wb3B1cFR5cGVFZGl0LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9pcy1hbmltYXRlZFwiKTtcclxuY29uc3QgcG9wdXBUeXBlTmV3Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX25ldy1jYXJkJyk7XHJcbnBvcHVwVHlwZU5ld0NhcmQuY2xhc3NMaXN0LmFkZChcInBvcHVwX2lzLWFuaW1hdGVkXCIpO1xyXG5jb25zdCBwb3B1cFR5cGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hdmF0YXInKTtcclxucG9wdXBUeXBlQXZhdGFyLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9pcy1hbmltYXRlZFwiKTtcclxuY29uc3QgcG9wdXBUeXBlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9pbWFnZScpO1xyXG5wb3B1cFR5cGVJbWFnZS5jbGFzc0xpc3QuYWRkKFwicG9wdXBfaXMtYW5pbWF0ZWRcIik7XHJcblxyXG5jb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdGl0bGUnKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyk7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyJyk7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbmNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1idXR0b24nKTtcclxuXHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbmNvbnN0IHBvcHVwSW1hZ2VDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJyk7XHJcbmxldCB1c2VySWQgPSBcIlwiO1xyXG5cclxuY29uc3QgZm9ybUFkZE5ld1Byb2ZpbGUgPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZVwiXTtcclxuY29uc3QgbmFtZUlucHV0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uJyk7XHJcbmNvbnN0IGZvcm1BZGROZXdDYXJkID0gZG9jdW1lbnQuZm9ybXNbXCJuZXctcGxhY2VcIl07XHJcbmNvbnN0IG5hbWVJbnB1dFBsdXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfY2FyZC1uYW1lJyk7XHJcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXRQbHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX3VybCcpO1xyXG5jb25zdCBmb3JtQWRkTmV3QXZhdGFyID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LWF2YXRhclwiXTtcclxuY29uc3QgbmFtZUlucHV0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2F2YXRhcicpO1xyXG4gIFxyXG4vLyDQotC10LzQv9C70LXQudGCINC60LDRgNGC0L7Rh9C60LggLy9cclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYXJkLXRlbXBsYXRlJykuY29udGVudDtcclxuY29uc3QgY2FyZFBsYWNlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2xpc3QnKTtcclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXHJcbiAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19idXR0b24nLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fYnV0dG9uX2Rpc2FibGVkJyxcclxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsXHJcbiAgZXJyb3JDbGFzczogJ3BvcHVwX19lcnJvcl92aXNpYmxlJ1xyXG59O1xyXG5cclxuZnVuY3Rpb24gcmVuZGVyaW5nKGJ1dHRvblNhdmUsIGNvbmRpdGlvbikge1xyXG4gIGJ1dHRvblNhdmUudGV4dENvbnRlbnQgPSBjb25kaXRpb247XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUZvcm1TdWJtaXRQcm9maWxlKGV2dCkge1xyXG4gIFxyXG4gIHJlbmRlcmluZyhldnQuc3VibWl0dGVyLCAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nKTtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgZWRpdE15UHJvZmlsZShcclxuICAgIG5hbWVJbnB1dFByb2ZpbGUudmFsdWUsXHJcbiAgICBkZXNjcmlwdGlvbklucHV0UHJvZmlsZS52YWx1ZVxyXG4gIClcclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBwcm9maWxlVGl0bGUudGV4dENvbnRlbnQgPSByZXN1bHQubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHJlc3VsdC5hYm91dDtcclxuICAgIGV2dC50YXJnZXQucmVzZXQoKTtcclxuICAgIGNsb3NlUG9wdXAocG9wdXBUeXBlRWRpdCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxuICAuZmluYWxseSgoKSA9PiByZW5kZXJpbmcoZXZ0LnN1Ym1pdHRlciwgJ9Ch0L7RhdGA0LDQvdC40YLRjCcpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdEFkZE5ld0NhcmQoZXZ0KSB7XHJcblxyXG4gIHJlbmRlcmluZyhldnQuc3VibWl0dGVyLCAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nKTtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY3JlYXRlQ2FyZE5ldyh7XHJcbiAgICBuYW1lOiBuYW1lSW5wdXRQbHVzLnZhbHVlLFxyXG4gICAgbGluazogZGVzY3JpcHRpb25JbnB1dFBsdXMudmFsdWUsXHJcbiAgfSlcclxuICAudGhlbigobmV3Q2FyZCkgPT4ge1xyXG4gICAgY29uc3QgbmV3QWRkQ2FyZCA9IGNyZWF0ZUNhcmQobmV3Q2FyZCwgcHJlc3NMaWtlLCBkZWxldGVDYXJkcywgc2hvd0NhcmQsIHVzZXJJZCk7XHJcbiAgICBuYW1lSW5wdXRQbHVzLnZhbHVlID0gXCJcIjtcclxuICAgIGRlc2NyaXB0aW9uSW5wdXRQbHVzLnZhbHVlID0gXCJcIjtcclxuICAgIGNhcmRQbGFjZUxpc3QucHJlcGVuZChuZXdBZGRDYXJkKTtcclxuICAgIGV2dC50YXJnZXQucmVzZXQoKTtcclxuICAgIGNsb3NlUG9wdXAocG9wdXBUeXBlTmV3Q2FyZCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxuICAuZmluYWxseSgoKSA9PiByZW5kZXJpbmcoZXZ0LnN1Ym1pdHRlciwgJ9Ch0L7RhdGA0LDQvdC40YLRjCcpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdEF2YXRhcihldnQpIHtcclxuXHJcbiAgcmVuZGVyaW5nKGV2dC5zdWJtaXR0ZXIsICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicpO1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICB1cGRhdGVNeUF2YXRhcih7IGF2YXRhcjogbmFtZUlucHV0QXZhdGFyLnZhbHVlIH0pXHJcbiAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIHByb2ZpbGVBdmF0YXIuc3R5bGUgPSBgYmFja2dyb3VuZC1pbWFnZTogdXJsKCR7ZGF0YS5hdmF0YXJ9KWA7XHJcbiAgICBjbG9zZVBvcHVwKHBvcHVwVHlwZUF2YXRhcik7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxuICAuZmluYWxseSgoKSA9PiByZW5kZXJpbmcoZXZ0LnN1Ym1pdHRlciwgJ9Ch0L7RhdGA0LDQvdC40YLRjCcpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHJlc3NMaWtlKGlkLCBpc0xpa2VkLCBjaGFuZ2VMaWtlKSB7XHJcbiAgY2xpY2tPbkxpa2UoaWQsIGlzTGlrZWQpXHJcbiAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIGNoYW5nZUxpa2UoZGF0YS5saWtlcylcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBkZWxldGVDYXJkcyhpZCwgZGVsZXRlQ2FyZCkge1xyXG4gIGRlbGV0ZU15Q2FyZChpZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgZGVsZXRlQ2FyZCgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dDYXJkKGl0ZW0pIHtcclxuICBwb3B1cEltYWdlLnNyYyA9IGl0ZW0ubGluaztcclxuICBwb3B1cEltYWdlLmFsdCA9IGl0ZW0ubmFtZTtcclxuICBwb3B1cEltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGl0ZW0ubmFtZTtcclxuICBvcGVuUG9wdXAocG9wdXBUeXBlSW1hZ2UpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuUG9wdXBQcm9maWxlKCkge1xyXG4gIG9wZW5Qb3B1cChwb3B1cFR5cGVFZGl0KTtcclxuICBuYW1lSW5wdXRQcm9maWxlLnZhbHVlID0gcHJvZmlsZVRpdGxlLnRleHRDb250ZW50XHJcbiAgZGVzY3JpcHRpb25JbnB1dFByb2ZpbGUudmFsdWUgPSAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gIGNsZWFyVmFsaWRhdGlvbihwb3B1cFR5cGVFZGl0LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblBvcHVwQWRkTmV3Q2FyZCgpIHtcclxuICBvcGVuUG9wdXAocG9wdXBUeXBlTmV3Q2FyZCk7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKHBvcHVwVHlwZU5ld0NhcmQsIHZhbGlkYXRpb25Db25maWcpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuUG9wdXBBdmF0YXIoKSB7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKHBvcHVwVHlwZUF2YXRhciwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgb3BlblBvcHVwKHBvcHVwVHlwZUF2YXRhcik7XHJcbiAgbmFtZUlucHV0QXZhdGFyLnZhbHVlID0gXCJcIjtcclxufVxyXG5cclxuUHJvbWlzZS5hbGwoW2dldEluaXRpYWxDYXJkcygpLCBnZXRVc2VyRGF0YSgpXSlcclxuICAudGhlbigoW2NhcmRzLCB1c2VyRGF0YV0pID0+IHtcclxuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuICAgIHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICAgIHByb2ZpbGVBdmF0YXIuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3VzZXJEYXRhLmF2YXRhcn0pYDtcclxuXHJcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNhcmRQbGFjZUxpc3QuYXBwZW5kKGNyZWF0ZUNhcmQoaXRlbSwgcHJlc3NMaWtlLCBkZWxldGVDYXJkcywgc2hvd0NhcmQsIHVzZXJJZCkpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7XHJcblxyXG5mb3JtQWRkTmV3UHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0UHJvZmlsZSk7XHJcbmZvcm1BZGROZXdDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUZvcm1TdWJtaXRBZGROZXdDYXJkKTtcclxuZm9ybUFkZE5ld0F2YXRhci5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0QXZhdGFyKTtcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblBvcHVwUHJvZmlsZSk7XHJcbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUG9wdXBBZGROZXdDYXJkKTtcclxucHJvZmlsZUF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Qb3B1cEF2YXRhcik7Il0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwib3BlblBvcHVwIiwicG9wdXAiLCJjbGFzc0xpc3QiLCJhZGQiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbG9zZUVzY1BvcHVwIiwiaGFuZGxlQ2xvc2VNb2RhbFdpbmRvd092ZXJsYXlDbGljayIsImV2ZW50IiwiY2xvc2VQb3B1cCIsInF1ZXJ5U2VsZWN0b3IiLCJjdXJyZW50VGFyZ2V0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY3JlYXRlQ2FyZCIsIml0ZW0iLCJwcmVzc0xpa2UiLCJkZWxldGVDYXJkcyIsInNob3dDYXJkIiwidXNlcklkIiwiY2FyZCIsImNhcmRUZW1wbGF0ZSIsImNsb25lTm9kZSIsImlkIiwiX2lkIiwiY2FyZEltYWdlIiwic3JjIiwibGluayIsImFsdCIsIm5hbWUiLCJjYXJkRGVsZXRlIiwidGV4dENvbnRlbnQiLCJsaWtlcyIsImNhcmRDb3VudGVyIiwiY2FyZExpa2UiLCJkZWxldGVDYXJkIiwib3duZXIiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJjaGVja0xpa2UiLCJzb21lIiwibGlrZSIsImNoYW5nZUxpa2UiLCJuZXdMaWtlcyIsInNldExpa2VTdGF0dXMiLCJsZW5ndGgiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwidmFsaWRhdGlvbkNvbmZpZyIsImVycm9yRWxlbWVudCIsImNvbmNhdCIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJkaXNhYmxlZEJ1dHRvbiIsImJ1dHRvbkVsZW1lbnQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJjbGVhclZhbGlkYXRpb24iLCJmb3JtTGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJmb3JFYWNoIiwiY29uZmlnIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiZ2V0UmVzcG9uc2VEYXRhIiwicmVzdWx0Iiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsInBvcHVwVHlwZUVkaXQiLCJwb3B1cFR5cGVOZXdDYXJkIiwicG9wdXBUeXBlQXZhdGFyIiwicG9wdXBUeXBlSW1hZ2UiLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQWRkQnV0dG9uIiwicHJvZmlsZUF2YXRhckJ1dHRvbiIsInBvcHVwSW1hZ2UiLCJwb3B1cEltYWdlQ2FwdGlvbiIsImZvcm1BZGROZXdQcm9maWxlIiwiZm9ybXMiLCJuYW1lSW5wdXRQcm9maWxlIiwiZGVzY3JpcHRpb25JbnB1dFByb2ZpbGUiLCJmb3JtQWRkTmV3Q2FyZCIsIm5hbWVJbnB1dFBsdXMiLCJkZXNjcmlwdGlvbklucHV0UGx1cyIsImZvcm1BZGROZXdBdmF0YXIiLCJuYW1lSW5wdXRBdmF0YXIiLCJjb250ZW50IiwiY2FyZFBsYWNlTGlzdCIsImZvcm1TZWxlY3RvciIsInJlbmRlcmluZyIsImJ1dHRvblNhdmUiLCJjb25kaXRpb24iLCJpc0xpa2VkIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwiY2xpY2tPbkxpa2UiLCJkYXRhIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJhbGwiLCJfcmVmIiwiX3JlZjIiLCJjYXJkcyIsInVzZXJEYXRhIiwiYWJvdXQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJhdmF0YXIiLCJhcHBlbmQiLCJwYXR0ZXJuTWlzbWF0Y2giLCJzZXRDdXN0b21WYWxpZGl0eSIsImRhdGFzZXQiLCJlcnJvck1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwiaW5wdXROYW1lIiwiaW5wdXREZXNjcmlwdGlvbiIsInN1Ym1pdHRlciIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc2V0IiwiZmluYWxseSIsIm5ld0NhcmQiLCJuZXdBZGRDYXJkIiwicHJlcGVuZCJdLCJzb3VyY2VSb290IjoiIn0=