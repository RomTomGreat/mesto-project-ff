(()=>{"use strict";function e(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",t),e.addEventListener("click",n)}function t(e){"Escape"===e.key&&r(document.querySelector(".popup_is-opened"))}function n(e){(e.currentTarget===e.target||e.target.classList.contains("popup__close"))&&r(e.currentTarget)}function r(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",t),e.removeEventListener("click",n)}function o(e,t,n,r,o){var c=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0);c.id=e._id;var a=c.querySelector(".card__image");a.src=e.link,a.alt=e.name;var u=c.querySelector(".card__delete-button");c.querySelector(".card__description").querySelector(".card__title").textContent=e.name;var i=e.likes,s=c.querySelector(".card__counter"),l=c.querySelector(".card__like-button");function d(){c.remove()}e.owner._id!==o&&(u.style.visibility="hidden");var p=function(){return i.some((function(e){return e._id===o}))},f=function(e){i=e,m()},m=function(){p()?l.classList.add("card__like-button_is-active"):l.classList.remove("card__like-button_is-active"),s.textContent=i.length};return m(),l.addEventListener("click",(function(){return t(e._id,p(),f)})),u.addEventListener("click",(function(){return n(e._id,d)})),a.addEventListener("click",(function(){return r(e)})),c}var c=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""},a=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled=!0)},u=function(e,t){Array.from(e.querySelectorAll(t.inputSelector)).forEach((function(t,n){c(e,t,n)}))},i={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"bb1fee31-957c-4b3e-9d5c-e5a39df6a8a4","Content-Type":"application/json"}};function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=document.querySelector(".popup_type_edit");l.classList.add("popup_is-animated");var d=document.querySelector(".popup_type_new-card");d.classList.add("popup_is-animated");var p=document.querySelector(".popup_type_avatar");p.classList.add("popup_is-animated");var f=document.querySelector(".popup_type_image");f.classList.add("popup_is-animated");var m=document.querySelector(".profile__title"),_=document.querySelector(".profile__description"),v=document.querySelector(".profile__avatar"),y=document.querySelector(".profile__edit-button"),h=document.querySelector(".profile__add-button"),b=document.querySelector(".profile__avatar-button"),S=document.querySelector(".popup__image"),q=document.querySelector(".popup__caption"),g="",E=document.forms["edit-profile"],L=document.querySelector(".popup__input_type_name"),k=document.querySelector(".popup__input_type_description"),C=document.forms["new-place"],j=document.querySelector(".popup__input_type_card-name"),A=document.querySelector(".popup__input_type_url"),x=document.forms["edit-avatar"],P=document.querySelector(".popup__input_type_avatar"),T=document.querySelector(".places__list"),w={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function U(e,t){e.textContent=t}function O(e,t,n){(function(e,t){return fetch("".concat(i.baseUrl,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))})(e,t).then((function(e){n(e.likes)})).catch((function(e){console.log(e)}))}function B(e,t){var n;(n=e,fetch("".concat(i.baseUrl,"/cards/").concat(n),{method:"DELETE",headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){t(e)})).catch((function(e){console.log(e)}))}function D(t){S.src=t.link,S.alt=t.name,q.textContent=t.name,e(f)}Promise.all([fetch("".concat(i.baseUrl,"/cards"),{method:"GET",headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),fetch("".concat(i.baseUrl,"/users/me"),{method:"GET",headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,u=[],i=!0,s=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=c.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,n)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=r[0],a=r[1];g=a.avatar,a._id,m.textContent=a.name,_.textContent=a.about,v.style.backgroundImage="url(".concat(a.avatar,")"),c.forEach((function(e){T.append(o(e,B,O,D))}))})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);a(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?c(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,o,t),a(n,r,t)}))}))}(t,e)}))}(w),E.addEventListener("submit",(function(e){var t,n;U(e.submitter,"Сохранение..."),e.preventDefault(),(t=L.value,n=k.value,fetch("".concat(i.baseUrl,"/users/me"),{method:"PATCH",headers:i.headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(t){m.textContent=t.name,_.textContent=t.about,e.target.reset(),r(l)})).catch((function(e){console.log(e)}))})),C.addEventListener("submit",(function(e){var t;U(e.submitter,"Сохранение..."),e.preventDefault(),(t={name:j.value,link:A.value},fetch("".concat(i.baseUrl,"/cards"),{method:"POST",headers:i.headers,body:JSON.stringify(t)}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(t){var n=o(t,B,O,D);j.value="",A.value="",T.prepend(n),e.target.reset(),r(d)})).catch((function(e){console.log(e)}))})),x.addEventListener("submit",(function(e){var t;U(e.submitter,"Сохранение..."),e.preventDefault(),(t={avatar:P.value},fetch("".concat(i.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:i.headers,body:JSON.stringify(t)}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){v.style="background-image: url(".concat(e.avatar,")"),g=e.avatar,r(p)})).catch((function(e){console.log(e)}))})),y.addEventListener("click",(function(){e(l),L.value=m.textContent,k.value=_.textContent,u(l,w)})),h.addEventListener("click",(function(){e(d),u(d,w)})),b.addEventListener("click",(function(){u(p,w),e(p),P.value=g}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFDaEJ1RSxLQUFNQyxLQUFLQyxVQUFVL0IsS0FHdEJSLE1BQUssU0FBQ0MsR0FDTCxPQUFJQSxFQUFPQyxHQUNGRCxFQUFPRSxPQUVQQyxRQUFRQyxPQUFPLFdBQUQxRCxPQUFZc0QsRUFBT0ssUUFFNUMsS0NoQkNOLE1BQUssU0FBQ1EsR0FDTGxDLEVBQWN6QyxNQUFRLHlCQUFIYyxPQUE0QjZELEVBQUtVLE9BQU0sS0FDMUR0QyxFQUFhNEIsRUFBS1UsT0FDbEJuSCxFQUFXbUUsRUFDYixJQUNDdUMsT0FBTSxTQUFDQyxHQUNOQyxRQUFRQyxJQUFJRixFQUNkLEdBQ0YsSUFxRUFuQyxFQUFrQjdFLGlCQUFpQixTQXhDbkMsV0FDRUwsRUFBVTJFLEdBQ1ZlLEVBQWlCcUQsTUFBUWhFLEVBQWE3QyxZQUN0Q3lELEVBQXdCb0QsTUFBUy9ELEVBQW1COUMsWUFDcEQrQixFQUFnQlUsRUFBZXZCLEVBQ2pDLElBb0NBK0IsRUFBaUI5RSxpQkFBaUIsU0FsQ2xDLFdBQ0VMLEVBQVU0RSxHQUNWWCxFQUFnQlcsRUFBa0J4QixFQUNwQyxJQWdDQWdDLEVBQW9CL0UsaUJBQWlCLFNBOUJyQyxXQUNFNEQsRUFBZ0JZLEVBQWlCekIsR0FDakNwRCxFQUFVNkUsR0FDVm1CLEVBQWdCK0MsTUFBUXhELENBQzFCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvbW9kYWxzLmpzIiwid2VicGFjazovL3lhbmRleC1wcmFrdGlrdW0vLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL3lhbmRleC1wcmFrdGlrdW0vLi9zcmMvY29tcG9uZW50cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3lhbmRleC1wcmFrdGlrdW0vLi9zcmMvY29tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8veWFuZGV4LXByYWt0aWt1bS8uL3NyYy9jb21wb25lbnRzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cCkge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9pcy1vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VFc2NQb3B1cCk7XHJcbiAgcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsb3NlTW9kYWxXaW5kb3dPdmVybGF5Q2xpY2spO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZUVzY1BvcHVwKGV2ZW50KSB7XHJcbiAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY2xvc2VQb3B1cChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfaXMtb3BlbmVkJykpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2xvc2VNb2RhbFdpbmRvd092ZXJsYXlDbGljayhldmVudCkge1xyXG4gIGlmIChldmVudC5jdXJyZW50VGFyZ2V0ID09PSBldmVudC50YXJnZXQgfHwgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlJykpIHtcclxuICAgIGNsb3NlUG9wdXAoZXZlbnQuY3VycmVudFRhcmdldCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwKSB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfaXMtb3BlbmVkJyk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VFc2NQb3B1cCk7XHJcbiAgcG9wdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsb3NlTW9kYWxXaW5kb3dPdmVybGF5Q2xpY2spO1xyXG59XHJcblxyXG5leHBvcnQge29wZW5Qb3B1cCwgY2xvc2VQb3B1cH07IiwiLy8g0KTRg9C90LrRhtC40Y8g0YHQvtC30LTQsNC90LjRjyDQutCw0YDRgtC+0YfQutC4IC8vXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0sIHByZXNzTGlrZSwgZGVsZXRlQ2FyZHMsIHNob3dDYXJkLCB1c2VySWQpIHtcclxuICAvLyDQotC10LzQv9C70LXQudGCINC60LDRgNGC0L7Rh9C60LggLy9cclxuICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZC10ZW1wbGF0ZScpLmNvbnRlbnQ7XHJcblxyXG4gIGNvbnN0IGNhcmQgPSBjYXJkVGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmNhcmQnKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY2FyZC5pZCA9IGl0ZW0uX2lkO1xyXG4gIFxyXG4gIGNvbnN0IGNhcmRJbWFnZSA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyk7XHJcbiAgY2FyZEltYWdlLnNyYyA9IGl0ZW0ubGluaztcclxuICBjYXJkSW1hZ2UuYWx0ID0gaXRlbS5uYW1lO1xyXG4gIC8vIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgc2hvdyAoaXRlbSkgfSk7XHJcbiAgXHJcbiAgY29uc3QgY2FyZERlbGV0ZSA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcclxuICAvLyBjYXJkRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVtb3ZlKTtcclxuICBcclxuICBjb25zdCBjYXJkRm9vdGVyQ29udGFpbmVyID0gY2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVzY3JpcHRpb24nKTtcclxuICAvLyBjb25zdCBsaWtlQ29udGFpbmVyID0gY2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb250YWluZXInKTtcclxuICBcclxuICBjb25zdCBjYXJkVGl0bGUgPSBjYXJkRm9vdGVyQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpO1xyXG4gIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGl0ZW0ubmFtZTtcclxuICBcclxuICBsZXQgbGlrZXMgPSBpdGVtLmxpa2VzO1xyXG5cclxuICBjb25zdCBjYXJkQ291bnRlciA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2NvdW50ZXInKTtcclxuICAvLyBjYXJkQ291bnRlci50ZXh0Q29udGVudCA9IGl0ZW0ubGlrZXMubGVuZ3RoO1xyXG5cclxuICBjb25zdCBjYXJkTGlrZSA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgLy8gY2FyZExpa2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsaWtlKTtcclxuICBcclxuICBmdW5jdGlvbiBkZWxldGVDYXJkKCkge1xyXG4gICAgY2FyZC5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNoZWNrRGVsZXRlSWNvbigpIHtcclxuICAgIGlmIChpdGVtLm93bmVyLl9pZCAhPT0gdXNlcklkKSB7XHJcbiAgICAgIGNhcmREZWxldGUuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNoZWNrRGVsZXRlSWNvbigpO1xyXG5cclxuICAvLyDQv9GA0L7QstC10YDRj9C10Lwg0LvQsNC50LrQvdGD0LvQuCDQu9C4INC80Ysg0LrQsNGA0YLQvtGH0LrRg1xyXG4gIGNvbnN0IGNoZWNrTGlrZSA9ICgpID0+IHtcclxuICAgIHJldHVybiBsaWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdXNlcklkKTtcclxuICB9O1xyXG4gIC8vINC+0LHQvdC+0LLQu9GP0LXRgiDRgtC10LrRg9GJ0LjQuSDQvNCw0YHRgdC40LIg0LvQsNC50LrQvtCyINC4INC+0LHQvdC+0LLQu9GP0LXRgiDRgdGC0LDRgtGD0YFcclxuICBjb25zdCB1cGRhdGVMaWtlcyA9IChuZXdMaWtlcykgPT4ge1xyXG4gICAgbGlrZXMgPSBuZXdMaWtlcztcclxuICAgIHNldExpa2VTdGF0dXMoKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBzZXRMaWtlU3RhdHVzID0gKCkgPT4ge1xyXG4gICAgY29uc3QgaXNMaWtlZCA9IGNoZWNrTGlrZSgpO1xyXG4gICAgaWYgKGlzTGlrZWQpIHtcclxuICAgICAgY2FyZExpa2UuY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjYXJkTGlrZS5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICAgIH1cclxuICAgIGNhcmRDb3VudGVyLnRleHRDb250ZW50ID0gbGlrZXMubGVuZ3RoO1xyXG4gIH07XHJcbiAgc2V0TGlrZVN0YXR1cygpO1xyXG5cclxuICBjYXJkTGlrZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgIHByZXNzTGlrZShpdGVtLl9pZCwgY2hlY2tMaWtlKCksIHVwZGF0ZUxpa2VzKSxcclxuICApO1xyXG4gIGNhcmREZWxldGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IFxyXG4gICAgZGVsZXRlQ2FyZHMoaXRlbS5faWQsIGRlbGV0ZUNhcmQpXHJcbiAgKTtcclxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IFxyXG4gICAgc2hvd0NhcmQoaXRlbSlcclxuICApO1xyXG5cclxuICByZXR1cm4gY2FyZDtcclxufSIsImNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHZhbGlkYXRpb25Db25maWcuZXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHZhbGlkYXRpb25Db25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG59O1xyXG4gIFxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkucGF0dGVybk1pc21hdGNoKSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuc2V0Q3VzdG9tVmFsaWRpdHkoaW5wdXRFbGVtZW50LmRhdGFzZXQuZXJyb3JNZXNzYWdlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KFwiXCIpO1xyXG4gIH1cclxuXHJcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH1cclxufTtcclxuICBcclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvbkNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodmFsaWRhdGlvbkNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG4gIFxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XHJcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gIH0pO1xyXG59XHJcbiAgXHJcbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG59XHJcbiAgXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9KVxyXG59XHJcbiAgXHJcbmNvbnN0IGNsZWFyVmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG4gIFxyXG5leHBvcnQge2VuYWJsZVZhbGlkYXRpb24sIGNsZWFyVmFsaWRhdGlvbn07IiwiY29uc3QgY29uZmlnID0ge1xyXG4gIGJhc2VVcmw6ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJyxcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiAnYmIxZmVlMzEtOTU3Yy00YjNlLTlkNWMtZTVhMzlkZjZhOGE0JyxcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRVc2VyRGF0YSA9ICgpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgbWV0aG9kOiAnR0VUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuICBcclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuICB9KVxyXG4gIFxyXG4gIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgIGlmIChyZXN1bHQub2spIHtcclxuICAgICAgcmV0dXJuIHJlc3VsdC5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXN1bHQuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH0pXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0TXlQcm9maWxlID0gKGlucHV0TmFtZSwgaW5wdXREZXNjcmlwdGlvbikgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZTogaW5wdXROYW1lLFxyXG4gICAgICBhYm91dDogaW5wdXREZXNjcmlwdGlvblxyXG4gICAgfSlcclxuICB9KVxyXG5cclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlQ2FyZE5ldyA9IChkYXRhKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxyXG4gIH0pXHJcblxyXG4gIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgIGlmIChyZXN1bHQub2spIHtcclxuICAgICAgcmV0dXJuIHJlc3VsdC5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXN1bHQuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH0pXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjbGlja09uTGlrZSA9IChpZCwgaXNMaWtlZCkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICBtZXRob2Q6IGlzTGlrZWQgPyAnREVMRVRFJyA6ICdQVVQnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuICB9KVxyXG5cclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlTXlDYXJkID0gKGRhdGEpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzLyR7ZGF0YX1gLCB7XHJcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuICB9KVxyXG5cclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlTXlBdmF0YXIgPSAoZGF0YSkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxyXG4gIH0pXHJcblxyXG4gIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgIGlmIChyZXN1bHQub2spIHtcclxuICAgICAgcmV0dXJuIHJlc3VsdC5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXN1bHQuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH0pXHJcbn0iLCJpbXBvcnQgJy4uL3BhZ2VzL2luZGV4LmNzcyc7XHJcbmltcG9ydCB7b3BlblBvcHVwLCBjbG9zZVBvcHVwfSBmcm9tICcuL21vZGFscyc7XHJcbmltcG9ydCB7Y3JlYXRlQ2FyZH0gZnJvbSAnLi9jYXJkJztcclxuaW1wb3J0IHtlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb259IGZyb20gJy4vdmFsaWRhdGlvbic7XHJcbmltcG9ydCB7Z2V0VXNlckRhdGEsIGdldEluaXRpYWxDYXJkcywgZWRpdE15UHJvZmlsZSwgY3JlYXRlQ2FyZE5ldywgY2xpY2tPbkxpa2UsIGRlbGV0ZU15Q2FyZCwgdXBkYXRlTXlBdmF0YXJ9IGZyb20gJy4vYXBpJztcclxuXHJcbmNvbnN0IHBvcHVwVHlwZUVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0Jyk7XHJcbnBvcHVwVHlwZUVkaXQuY2xhc3NMaXN0LmFkZChcInBvcHVwX2lzLWFuaW1hdGVkXCIpO1xyXG5jb25zdCBwb3B1cFR5cGVOZXdDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfbmV3LWNhcmQnKTtcclxucG9wdXBUeXBlTmV3Q2FyZC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfaXMtYW5pbWF0ZWRcIik7XHJcbmNvbnN0IHBvcHVwVHlwZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2F2YXRhcicpO1xyXG5wb3B1cFR5cGVBdmF0YXIuY2xhc3NMaXN0LmFkZChcInBvcHVwX2lzLWFuaW1hdGVkXCIpO1xyXG5jb25zdCBwb3B1cFR5cGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJyk7XHJcbnBvcHVwVHlwZUltYWdlLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9pcy1hbmltYXRlZFwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKTtcclxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXInKTtcclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyLWJ1dHRvbicpO1xyXG5cclxuY29uc3QgcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuY29uc3QgcG9wdXBJbWFnZUNhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKTtcclxuXHJcbmxldCB1c2VyQXZhdGFyID0gXCJcIjtcclxubGV0IHVzZXJWYWx1ZSA9IFwiXCI7XHJcblxyXG5jb25zdCBmb3JtQWRkTmV3UHJvZmlsZSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlXCJdO1xyXG5jb25zdCBuYW1lSW5wdXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX25hbWUnKTtcclxuY29uc3QgZGVzY3JpcHRpb25JbnB1dFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb24nKTtcclxuY29uc3QgZm9ybUFkZE5ld0NhcmQgPSBkb2N1bWVudC5mb3Jtc1tcIm5ldy1wbGFjZVwiXTtcclxuY29uc3QgbmFtZUlucHV0UGx1cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9jYXJkLW5hbWUnKTtcclxuY29uc3QgZGVzY3JpcHRpb25JbnB1dFBsdXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfdXJsJyk7XHJcbmNvbnN0IGZvcm1BZGROZXdBdmF0YXIgPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtYXZhdGFyXCJdO1xyXG5jb25zdCBuYW1lSW5wdXRBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfYXZhdGFyJyk7XHJcbiAgXHJcbmNvbnN0IGNhcmRQbGFjZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19saXN0Jyk7XHJcblxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZSdcclxufTtcclxuXHJcbmZ1bmN0aW9uIHJlbmRlcmluZyhidXR0b25TYXZlLCBjb25kaXRpb24pIHtcclxuICBidXR0b25TYXZlLnRleHRDb250ZW50ID0gY29uZGl0aW9uO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVGb3JtU3VibWl0UHJvZmlsZShldnQpIHtcclxuICBcclxuICByZW5kZXJpbmcoZXZ0LnN1Ym1pdHRlciwgJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJyk7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGVkaXRNeVByb2ZpbGUoXHJcbiAgICBuYW1lSW5wdXRQcm9maWxlLnZhbHVlLFxyXG4gICAgZGVzY3JpcHRpb25JbnB1dFByb2ZpbGUudmFsdWVcclxuICApXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgcHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID0gcmVzdWx0Lm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSByZXN1bHQuYWJvdXQ7XHJcbiAgICBldnQudGFyZ2V0LnJlc2V0KCk7XHJcbiAgICBjbG9zZVBvcHVwKHBvcHVwVHlwZUVkaXQpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUZvcm1TdWJtaXRBZGROZXdDYXJkKGV2dCkge1xyXG5cclxuICByZW5kZXJpbmcoZXZ0LnN1Ym1pdHRlciwgJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJyk7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNyZWF0ZUNhcmROZXcoe1xyXG4gICAgbmFtZTogbmFtZUlucHV0UGx1cy52YWx1ZSxcclxuICAgIGxpbms6IGRlc2NyaXB0aW9uSW5wdXRQbHVzLnZhbHVlLFxyXG4gIH0pXHJcbiAgLnRoZW4oKG5ld0NhcmQpID0+IHtcclxuICAgIGNvbnN0IG5ld0FkZENhcmQgPSBjcmVhdGVDYXJkKG5ld0NhcmQsIGRlbGV0ZUNhcmRzLCBwcmVzc0xpa2UsIHNob3dDYXJkKTtcclxuICAgIG5hbWVJbnB1dFBsdXMudmFsdWUgPSBcIlwiO1xyXG4gICAgZGVzY3JpcHRpb25JbnB1dFBsdXMudmFsdWUgPSBcIlwiO1xyXG4gICAgY2FyZFBsYWNlTGlzdC5wcmVwZW5kKG5ld0FkZENhcmQpO1xyXG4gICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgY2xvc2VQb3B1cChwb3B1cFR5cGVOZXdDYXJkKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVGb3JtU3VibWl0QXZhdGFyKGV2dCkge1xyXG5cclxuICByZW5kZXJpbmcoZXZ0LnN1Ym1pdHRlciwgJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJyk7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIHVwZGF0ZU15QXZhdGFyKHsgYXZhdGFyOiBuYW1lSW5wdXRBdmF0YXIudmFsdWUgfSlcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgcHJvZmlsZUF2YXRhci5zdHlsZSA9IGBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJHtkYXRhLmF2YXRhcn0pYDtcclxuICAgIHVzZXJBdmF0YXIgPSBkYXRhLmF2YXRhcjtcclxuICAgIGNsb3NlUG9wdXAocG9wdXBUeXBlQXZhdGFyKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBwcmVzc0xpa2UoaWQsIGlzTGlrZWQsIGNoYW5nZUxpa2UpIHtcclxuICBjbGlja09uTGlrZShpZCwgaXNMaWtlZClcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgY2hhbmdlTGlrZShkYXRhLmxpa2VzKVxyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUNhcmRzKGlkLCBkZWxldGVDYXJkKSB7XHJcbiAgZGVsZXRlTXlDYXJkKGlkKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgZGVsZXRlQ2FyZChkYXRhKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93Q2FyZChpdGVtKSB7XHJcbiAgcG9wdXBJbWFnZS5zcmMgPSBpdGVtLmxpbms7XHJcbiAgcG9wdXBJbWFnZS5hbHQgPSBpdGVtLm5hbWU7XHJcbiAgcG9wdXBJbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBpdGVtLm5hbWU7XHJcbiAgb3BlblBvcHVwKHBvcHVwVHlwZUltYWdlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblBvcHVwUHJvZmlsZSgpIHtcclxuICBvcGVuUG9wdXAocG9wdXBUeXBlRWRpdCk7XHJcbiAgbmFtZUlucHV0UHJvZmlsZS52YWx1ZSA9IHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudFxyXG4gIGRlc2NyaXB0aW9uSW5wdXRQcm9maWxlLnZhbHVlID0gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICBjbGVhclZhbGlkYXRpb24ocG9wdXBUeXBlRWRpdCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Qb3B1cEFkZE5ld0NhcmQoKSB7XHJcbiAgb3BlblBvcHVwKHBvcHVwVHlwZU5ld0NhcmQpO1xyXG4gIGNsZWFyVmFsaWRhdGlvbihwb3B1cFR5cGVOZXdDYXJkLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblBvcHVwQXZhdGFyKCkge1xyXG4gIGNsZWFyVmFsaWRhdGlvbihwb3B1cFR5cGVBdmF0YXIsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIG9wZW5Qb3B1cChwb3B1cFR5cGVBdmF0YXIpO1xyXG4gIG5hbWVJbnB1dEF2YXRhci52YWx1ZSA9IHVzZXJBdmF0YXI7XHJcbn1cclxuXHJcblByb21pc2UuYWxsKFtnZXRJbml0aWFsQ2FyZHMoKSwgZ2V0VXNlckRhdGEoKV0pXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlckRhdGFdKSA9PiB7XHJcbiAgICB1c2VyQXZhdGFyID0gdXNlckRhdGEuYXZhdGFyO1xyXG4gICAgdXNlclZhbHVlID0gdXNlckRhdGEuX2lkO1xyXG4gICAgcHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xyXG4gICAgcHJvZmlsZUF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dXNlckRhdGEuYXZhdGFyfSlgO1xyXG5cclxuICAgIGNhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgY2FyZFBsYWNlTGlzdC5hcHBlbmQoY3JlYXRlQ2FyZChpdGVtLCBkZWxldGVDYXJkcywgcHJlc3NMaWtlLCBzaG93Q2FyZCkpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7XHJcblxyXG5mb3JtQWRkTmV3UHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0UHJvZmlsZSk7XHJcbmZvcm1BZGROZXdDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUZvcm1TdWJtaXRBZGROZXdDYXJkKTtcclxuZm9ybUFkZE5ld0F2YXRhci5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0QXZhdGFyKTtcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblBvcHVwUHJvZmlsZSk7XHJcbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUG9wdXBBZGROZXdDYXJkKTtcclxucHJvZmlsZUF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Qb3B1cEF2YXRhcik7Il0sIm5hbWVzIjpbIm9wZW5Qb3B1cCIsInBvcHVwIiwiY2xhc3NMaXN0IiwiYWRkIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2VFc2NQb3B1cCIsImhhbmRsZUNsb3NlTW9kYWxXaW5kb3dPdmVybGF5Q2xpY2siLCJldmVudCIsImtleSIsImNsb3NlUG9wdXAiLCJxdWVyeVNlbGVjdG9yIiwiY3VycmVudFRhcmdldCIsInRhcmdldCIsImNvbnRhaW5zIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNyZWF0ZUNhcmQiLCJpdGVtIiwicHJlc3NMaWtlIiwiZGVsZXRlQ2FyZHMiLCJzaG93Q2FyZCIsInVzZXJJZCIsImNhcmQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiaWQiLCJfaWQiLCJjYXJkSW1hZ2UiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsImNhcmREZWxldGUiLCJ0ZXh0Q29udGVudCIsImxpa2VzIiwiY2FyZENvdW50ZXIiLCJjYXJkTGlrZSIsImRlbGV0ZUNhcmQiLCJvd25lciIsInN0eWxlIiwidmlzaWJpbGl0eSIsImNoZWNrTGlrZSIsInNvbWUiLCJsaWtlIiwidXBkYXRlTGlrZXMiLCJuZXdMaWtlcyIsInNldExpa2VTdGF0dXMiLCJsZW5ndGgiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwidmFsaWRhdGlvbkNvbmZpZyIsImVycm9yRWxlbWVudCIsImNvbmNhdCIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiY2xlYXJWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJmb3JFYWNoIiwiY29uZmlnIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwicG9wdXBUeXBlRWRpdCIsInBvcHVwVHlwZU5ld0NhcmQiLCJwb3B1cFR5cGVBdmF0YXIiLCJwb3B1cFR5cGVJbWFnZSIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVBdmF0YXIiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJwcm9maWxlQXZhdGFyQnV0dG9uIiwicG9wdXBJbWFnZSIsInBvcHVwSW1hZ2VDYXB0aW9uIiwidXNlckF2YXRhciIsImZvcm1BZGROZXdQcm9maWxlIiwiZm9ybXMiLCJuYW1lSW5wdXRQcm9maWxlIiwiZGVzY3JpcHRpb25JbnB1dFByb2ZpbGUiLCJmb3JtQWRkTmV3Q2FyZCIsIm5hbWVJbnB1dFBsdXMiLCJkZXNjcmlwdGlvbklucHV0UGx1cyIsImZvcm1BZGROZXdBdmF0YXIiLCJuYW1lSW5wdXRBdmF0YXIiLCJjYXJkUGxhY2VMaXN0IiwiZm9ybVNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJyZW5kZXJpbmciLCJidXR0b25TYXZlIiwiY29uZGl0aW9uIiwiaXNMaWtlZCIsImNoYW5nZUxpa2UiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJyZXN1bHQiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2xpY2tPbkxpa2UiLCJkYXRhIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJhbGwiLCJfcmVmIiwiX3JlZjIiLCJjYXJkcyIsInVzZXJEYXRhIiwiYXZhdGFyIiwiYWJvdXQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJhcHBlbmQiLCJwYXR0ZXJuTWlzbWF0Y2giLCJzZXRDdXN0b21WYWxpZGl0eSIsImRhdGFzZXQiLCJlcnJvck1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwiaW5wdXROYW1lIiwiaW5wdXREZXNjcmlwdGlvbiIsInN1Ym1pdHRlciIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc2V0IiwibmV3Q2FyZCIsIm5ld0FkZENhcmQiLCJwcmVwZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==