(()=>{"use strict";function e(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",t),e.addEventListener("click",n)}function t(e){"Escape"===e.key&&r(document.querySelector(".popup_is-opened"))}function n(e){(e.currentTarget===e.target||e.target.classList.contains("popup__close"))&&r(e.currentTarget)}function r(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",t),e.removeEventListener("click",n)}function o(e,t,n,r){var o=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),c=o.querySelector(".card__image");return c.src=e.link,c.alt=e.name,c.addEventListener("click",(function(){r(e)})),o.querySelector(".card__delete-button").addEventListener("click",t),o.querySelector(".card__description").querySelector(".card__title").textContent=e.name,o.querySelector(".card__counter").textContent=e.likes.length,o.querySelector(".card__like-button").addEventListener("click",n),o}function c(e){e.target.closest(".card").remove()}function a(e){e.target.closest(".card__like-button").classList.toggle("card__like-button_is-active")}var u=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""},i=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled=!0)},s=function(e,t){Array.from(e.querySelectorAll(t.inputSelector)).forEach((function(t,n){u(e,t,n)}))},l={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"bb1fee31-957c-4b3e-9d5c-e5a39df6a8a4","Content-Type":"application/json"}};function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=document.querySelector(".popup_type_edit");p.classList.add("popup_is-animated");var f=document.querySelector(".popup_type_new-card");f.classList.add("popup_is-animated");var m=document.querySelector(".popup_type_image");m.classList.add("popup_is-animated");var _=document.querySelector(".profile__title"),y=document.querySelector(".profile__description"),v=document.querySelector(".profile__edit-button"),h=document.querySelector(".profile__add-button"),S=document.querySelector(".popup__image"),b=document.querySelector(".popup__caption"),g=document.forms["edit-profile"],q=document.querySelector(".popup__input_type_name"),C=document.querySelector(".popup__input_type_description"),L=document.forms["new-place"],E=document.querySelector(".popup__input_type_card-name"),k=document.querySelector(".popup__input_type_url"),j=document.querySelector(".places__list");function x(t){S.src=t.link,S.alt=t.name,b.textContent=t.name,e(m)}g.addEventListener("submit",(function(e){var t,n;e.preventDefault(),_.textContent=q.value,y.textContent=C.value,(t=q.value,n=C.value,fetch("".concat(l.baseUrl,"/users/me"),{method:"PATCH",headers:l.headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)}))).then((function(t){_.textContent=t.name,y.textContent=t.about,e.target.reset(),r(p),console.log(t)}))})),L.addEventListener("submit",(function(e){var t;e.preventDefault(),(t={name:E.value,link:k.value},fetch("".concat(l.baseUrl,"/cards"),{method:"POST",headers:l.headers,body:JSON.stringify(t)}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)}))).then((function(t){var n=o(t,c,a,x);j.prepend(n),e.target.reset(),r(f)}))})),v.addEventListener("click",(function(){q.value=_.textContent,C.value=y.textContent,s(p,A),e(p)})),h.addEventListener("click",(function(){s(f,A),e(f)})),Promise.all([fetch("".concat(l.baseUrl,"/cards"),{method:"GET",headers:l.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)})),fetch("".concat(l.baseUrl,"/users/me"),{method:"GET",headers:l.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)}))]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,u=[],i=!0,s=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=c.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,n)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=r[0],i=r[1];_.textContent=i.name,y.textContent=i.about,u.forEach((function(e){j.append(o(e,c,a,x))}))})).catch((function(e){console.log(e)}));var A={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};!function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);i(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?u(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,o,t),i(n,r,t)}))}))}(t,e)}))}(A)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ckIsR0FDakJBLEVBQWFsQyxpQkFBaUIsU0FBUyxZQW5CaEIsU0FBQ2lDLEVBQWFDLEVBQWNDLEdBQ2pERCxFQUFhVyxTQUFTbUUsZ0JBQ3hCOUUsRUFBYStFLGtCQUFrQi9FLEVBQWFnRixRQUFRQyxjQUVwRGpGLEVBQWErRSxrQkFBa0IsSUFHNUIvRSxFQUFhVyxTQUFTQyxNQUd6QmQsRUFBZUMsRUFBYUMsRUFBY0MsR0F4QnZCLFNBQUNGLEVBQWFDLEVBQWNpRixFQUFjaEYsR0FDL0QsSUFBTUMsRUFBZUgsRUFBWTNCLGNBQWMsSUFBRCtCLE9BQUtILEVBQWFJLEdBQUUsV0FDbEVKLEVBQWFyQyxVQUFVQyxJQUFJcUMsRUFBaUJJLGlCQUM1Q0gsRUFBYVosWUFBYzJGLEVBQzNCL0UsRUFBYXZDLFVBQVVDLElBQUlxQyxFQUFpQkssV0FDOUMsQ0FpQkk0RSxDQUFlbkYsRUFBYUMsRUFBY0EsRUFBYW1GLGtCQUFtQmxGLEVBSTlFLENBUU1tRixDQUFtQnJGLEVBQWFDLEVBQWNDLEdBQzlDTSxFQUFrQkMsRUFBV0MsRUFBZVIsRUFDOUMsR0FDRixHQUNGLENBcUJJb0YsQ0FBa0J0RixFQUFhRSxFQUNqQyxHQUNGLENFMkRBcUYsQ0FBaUJyRixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veWFuZGV4LXByYWt0aWt1bS8uL3NyYy9jb21wb25lbnRzL21vZGFscy5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvY2FyZC5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvYXBpLmpzIiwid2VicGFjazovL3lhbmRleC1wcmFrdGlrdW0vLi9zcmMvY29tcG9uZW50cy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBvcGVuUG9wdXAocG9wdXApIHtcclxuICBwb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfaXMtb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlRXNjUG9wdXApO1xyXG4gIHBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDbG9zZU1vZGFsV2luZG93T3ZlcmxheUNsaWNrKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VFc2NQb3B1cChldmVudCkge1xyXG4gIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNsb3NlUG9wdXAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2lzLW9wZW5lZCcpKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNsb3NlTW9kYWxXaW5kb3dPdmVybGF5Q2xpY2soZXZlbnQpIHtcclxuICBpZiAoZXZlbnQuY3VycmVudFRhcmdldCA9PT0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZScpKSB7XHJcbiAgICBjbG9zZVBvcHVwKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VQb3B1cChwb3B1cCkge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2lzLW9wZW5lZCcpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlRXNjUG9wdXApO1xyXG4gIHBvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDbG9zZU1vZGFsV2luZG93T3ZlcmxheUNsaWNrKTtcclxufVxyXG5cclxuZXhwb3J0IHtvcGVuUG9wdXAsIGNsb3NlUG9wdXB9OyIsIi8vINCk0YPQvdC60YbQuNGPINGB0L7Qt9C00LDQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuCAvL1xyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0sIHJlbW92ZSwgbGlrZSwgc2hvdykge1xyXG4gIC8vINCi0LXQvNC/0LvQtdC50YIg0LrQsNGA0YLQvtGH0LrQuCAvL1xyXG4gIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYXJkLXRlbXBsYXRlJykuY29udGVudDtcclxuXHJcbiAgY29uc3QgY2FyZCA9IGNhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpLmNsb25lTm9kZSh0cnVlKTtcclxuICBcclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xyXG5cclxuICBjYXJkSW1hZ2Uuc3JjID0gaXRlbS5saW5rO1xyXG4gIGNhcmRJbWFnZS5hbHQgPSBpdGVtLm5hbWU7XHJcbiAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBzaG93IChpdGVtKSB9KTtcclxuICBcclxuICBjb25zdCBjYXJkRGVsZXRlID0gY2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpO1xyXG4gIGNhcmREZWxldGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZW1vdmUpO1xyXG4gIFxyXG4gIGNvbnN0IGNhcmRGb290ZXJDb250YWluZXIgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZXNjcmlwdGlvbicpO1xyXG4gIFxyXG4gIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRGb290ZXJDb250YWluZXIucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJyk7XHJcbiAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gaXRlbS5uYW1lO1xyXG4gIFxyXG5cclxuICBjb25zdCBjYXJkQ291bnRlciA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2NvdW50ZXInKTtcclxuICBjYXJkQ291bnRlci50ZXh0Q29udGVudCA9IGl0ZW0ubGlrZXMubGVuZ3RoO1xyXG5cclxuICBjb25zdCBjYXJkTGlrZSA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgY2FyZExpa2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsaWtlKTtcclxuICBcclxuICByZXR1cm4gY2FyZDtcclxufVxyXG4vLyDQpNGD0L3QutGG0LjRjyDRg9C00LDQu9C10L3QuNGPINC60LDRgNGC0L7Rh9C60LggLy9cclxuZnVuY3Rpb24gZGVsZXRlQ2FyZCAoZXZ0KSB7XHJcbiAgY29uc3QgdHJhc2ggPSBldnQudGFyZ2V0LmNsb3Nlc3QoJy5jYXJkJyk7XHJcbiAgdHJhc2gucmVtb3ZlKCk7XHJcbn1cclxuLy8g0KTRg9C90LrRhtC40Y8g0L3QsNC20LDRgtC40Y8g0L3QsCDQu9Cw0LnQuiAvL1xyXG5mdW5jdGlvbiBwcmVzc0xpa2UgKGV2dCkge1xyXG4gIGNvbnN0IGhlYWx0aCA9IGV2dC50YXJnZXQuY2xvc2VzdCgnLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgaGVhbHRoLmNsYXNzTGlzdC50b2dnbGUoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG59XHJcblxyXG5leHBvcnQge2NyZWF0ZUNhcmQsIGRlbGV0ZUNhcmQsIHByZXNzTGlrZX07IiwiY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCB2YWxpZGF0aW9uQ29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHZhbGlkYXRpb25Db25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5lcnJvckNsYXNzKTtcclxufTtcclxuICBcclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodmFsaWRhdGlvbkNvbmZpZy5lcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxufTtcclxuICBcclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yTWVzc2FnZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eShcIlwiKTtcclxuICB9XHJcblxyXG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9XHJcbn07XHJcbiAgXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuICBcclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufVxyXG4gIFxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxufVxyXG4gIFxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfSlcclxufVxyXG4gIFxyXG5jb25zdCBjbGVhclZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9KTtcclxufTtcclxuICBcclxuZXhwb3J0IHtlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb259OyIsImNvbnN0IGNvbmZpZyA9IHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtMicsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogJ2JiMWZlZTMxLTk1N2MtNGIzZS05ZDVjLWU1YTM5ZGY2YThhNCcsXHJcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VXNlckRhdGEgPSAoKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xyXG4gIH0pXHJcbiAgXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgaWYgKHJlc3VsdC5vaykge1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlc3VsdC5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldEluaXRpYWxDYXJkcyA9ICgpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgbWV0aG9kOiAnR0VUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuICBcclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZWRpdE15UHJvZmlsZSA9IChpbnB1dE5hbWUsIGlucHV0RGVzY3JpcHRpb24pID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIG5hbWU6IGlucHV0TmFtZSxcclxuICAgICAgYWJvdXQ6IGlucHV0RGVzY3JpcHRpb25cclxuICAgIH0pXHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgaWYgKHJlc3VsdC5vaykge1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlc3VsdC5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUNhcmROZXcgPSAoZGF0YSkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcclxuICB9KVxyXG5cclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY2xpY2tPbkxpa2UgPSAoaWQsIGlzTGlrZWQpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgbWV0aG9kOiBpc0xpa2VkID8gJ0RFTEVURScgOiAnUFVUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgaWYgKHJlc3VsdC5vaykge1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlc3VsdC5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZU15Q2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy8ke2RhdGF9YCwge1xyXG4gICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgaWYgKHJlc3VsdC5vaykge1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlc3VsdC5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHVwZGF0ZU15QXZhdGFyID0gKGRhdGEpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcclxuICB9KVxyXG5cclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59IiwiaW1wb3J0ICcuLi9wYWdlcy9pbmRleC5jc3MnO1xyXG5pbXBvcnQge29wZW5Qb3B1cCwgY2xvc2VQb3B1cH0gZnJvbSAnLi9tb2RhbHMnO1xyXG5pbXBvcnQge2NyZWF0ZUNhcmQsIGRlbGV0ZUNhcmQsIHByZXNzTGlrZX0gZnJvbSAnLi9jYXJkJztcclxuaW1wb3J0IHtlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb259IGZyb20gJy4vdmFsaWRhdGlvbic7XHJcbmltcG9ydCB7Z2V0VXNlckRhdGEsIGdldEluaXRpYWxDYXJkcywgZWRpdE15UHJvZmlsZSwgY3JlYXRlQ2FyZE5ldywgY2xpY2tPbkxpa2UsIGRlbGV0ZU15Q2FyZCwgdXBkYXRlTXlBdmF0YXJ9IGZyb20gJy4vYXBpJztcclxuXHJcbmNvbnN0IHBvcHVwVHlwZUVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0Jyk7XHJcbnBvcHVwVHlwZUVkaXQuY2xhc3NMaXN0LmFkZChcInBvcHVwX2lzLWFuaW1hdGVkXCIpO1xyXG5jb25zdCBwb3B1cFR5cGVOZXdDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfbmV3LWNhcmQnKTtcclxucG9wdXBUeXBlTmV3Q2FyZC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfaXMtYW5pbWF0ZWRcIik7XHJcbmNvbnN0IHBvcHVwVHlwZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UnKTtcclxucG9wdXBUeXBlSW1hZ2UuY2xhc3NMaXN0LmFkZChcInBvcHVwX2lzLWFuaW1hdGVkXCIpO1xyXG4vL2NvbnN0IGNhcmRMaWtlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKTtcclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbmNvbnN0IHBvcHVwSW1hZ2VDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJyk7XHJcbi8vINCd0LDRhdC+0LTQuNC8IDEg0YTQvtGA0LzRgyDQsiBET00gLy9cclxuY29uc3QgZm9ybUFkZE5ld1Byb2ZpbGUgPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZVwiXTtcclxuLy8g0J3QsNGF0L7QtNC40LwgMSDQv9C+0LvRjyDRhNC+0YDQvNGLINCyIERPTSAvL1xyXG5jb25zdCBuYW1lSW5wdXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX25hbWUnKTtcclxuY29uc3QgZGVzY3JpcHRpb25JbnB1dFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb24nKTtcclxuLy8g0J3QsNGF0L7QtNC40LwgMiDRhNC+0YDQvNGDINCyIERPTSAvL1xyXG5jb25zdCBmb3JtQWRkTmV3Q2FyZCA9IGRvY3VtZW50LmZvcm1zW1wibmV3LXBsYWNlXCJdO1xyXG4vLyDQndCw0YXQvtC00LjQvCAyINC/0L7Qu9GPINGE0L7RgNC80Ysg0LIgRE9NIC8vXHJcbmNvbnN0IG5hbWVJbnB1dFBsdXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfY2FyZC1uYW1lJyk7XHJcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXRQbHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX3VybCcpO1xyXG4vLyBET00g0YPQt9C70YsgLy9cclxuY29uc3QgY2FyZFBsYWNlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2xpc3QnKTtcclxuXHJcbmZ1bmN0aW9uIHNob3dDYXJkIChpdGVtKSB7XHJcbiAgcG9wdXBJbWFnZS5zcmMgPSBpdGVtLmxpbms7XHJcbiAgcG9wdXBJbWFnZS5hbHQgPSBpdGVtLm5hbWU7XHJcbiAgcG9wdXBJbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBpdGVtLm5hbWU7XHJcbiAgb3BlblBvcHVwKHBvcHVwVHlwZUltYWdlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdFByb2ZpbGUoZXZ0KSB7XHJcbiAgICBcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBwcm9maWxlVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lSW5wdXRQcm9maWxlLnZhbHVlO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uSW5wdXRQcm9maWxlLnZhbHVlO1xyXG4gIGVkaXRNeVByb2ZpbGUoXHJcbiAgICBuYW1lSW5wdXRQcm9maWxlLnZhbHVlLFxyXG4gICAgZGVzY3JpcHRpb25JbnB1dFByb2ZpbGUudmFsdWVcclxuICApXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgcHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID0gcmVzdWx0Lm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSByZXN1bHQuYWJvdXQ7XHJcbiAgICBcclxuICAgIGV2dC50YXJnZXQucmVzZXQoKTtcclxuICAgIGNsb3NlUG9wdXAocG9wdXBUeXBlRWRpdCk7XHJcbiAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVN1Ym1pdEFkZE5ld0NhcmQoZXZ0KSB7XHJcblxyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIFxyXG4gIGNyZWF0ZUNhcmROZXcoe1xyXG4gICAgbmFtZTogbmFtZUlucHV0UGx1cy52YWx1ZSxcclxuICAgIGxpbms6IGRlc2NyaXB0aW9uSW5wdXRQbHVzLnZhbHVlLFxyXG4gIH0pXHJcbiAgLnRoZW4oKG5ld0NhcmQpID0+IHtcclxuICAgIGNvbnN0IG5ld0FkZENhcmQgPSBjcmVhdGVDYXJkKG5ld0NhcmQsIGRlbGV0ZUNhcmQsIHByZXNzTGlrZSwgc2hvd0NhcmQpO1xyXG4gICAgY2FyZFBsYWNlTGlzdC5wcmVwZW5kKG5ld0FkZENhcmQpO1xyXG4gIFxyXG4gICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgY2xvc2VQb3B1cChwb3B1cFR5cGVOZXdDYXJkKTtcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuUG9wdXBQcm9maWxlKCkge1xyXG4gIG5hbWVJbnB1dFByb2ZpbGUudmFsdWUgPSBwcm9maWxlVGl0bGUudGV4dENvbnRlbnRcclxuICBkZXNjcmlwdGlvbklucHV0UHJvZmlsZS52YWx1ZSA9ICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKHBvcHVwVHlwZUVkaXQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIG9wZW5Qb3B1cChwb3B1cFR5cGVFZGl0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblBvcHVwQWRkTmV3Q2FyZCgpIHtcclxuICBjbGVhclZhbGlkYXRpb24ocG9wdXBUeXBlTmV3Q2FyZCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgb3BlblBvcHVwKHBvcHVwVHlwZU5ld0NhcmQpO1xyXG59XHJcblxyXG5mb3JtQWRkTmV3UHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0UHJvZmlsZSk7XHJcbmZvcm1BZGROZXdDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZVN1Ym1pdEFkZE5ld0NhcmQpO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUG9wdXBQcm9maWxlKTtcclxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Qb3B1cEFkZE5ld0NhcmQpO1xyXG5cclxuUHJvbWlzZS5hbGwoW2dldEluaXRpYWxDYXJkcygpLCBnZXRVc2VyRGF0YSgpXSkudGhlbigoW2NhcmRzLCB1c2VyRGF0YV0pID0+IHtcclxuICBwcm9maWxlVGl0bGUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xyXG4gIGNhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgIGNhcmRQbGFjZUxpc3QuYXBwZW5kKGNyZWF0ZUNhcmQoaXRlbSwgZGVsZXRlQ2FyZCwgcHJlc3NMaWtlLCBzaG93Q2FyZCkpO1xyXG4gIH0pO1xyXG59KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG5cclxuLy8gICAudGhlbigocmVzdWx0KSA9PiB7XHJcbi8vICAgICBjb25zdCBsaWtlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbi8vICAgICBjb25zdCBjYXJkQ291bnRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19jb3VudGVyJyk7XHJcbi8vICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG4vLyAgICAgY2FyZENvdW50ZXIudGV4dENvbnRlbnQgPSByZXN1bHQubGlrZXMubGVuZ3RoO1xyXG4vLyAgIH0pXHJcblxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZSdcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7Il0sIm5hbWVzIjpbIm9wZW5Qb3B1cCIsInBvcHVwIiwiY2xhc3NMaXN0IiwiYWRkIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2VFc2NQb3B1cCIsImhhbmRsZUNsb3NlTW9kYWxXaW5kb3dPdmVybGF5Q2xpY2siLCJldmVudCIsImtleSIsImNsb3NlUG9wdXAiLCJxdWVyeVNlbGVjdG9yIiwiY3VycmVudFRhcmdldCIsInRhcmdldCIsImNvbnRhaW5zIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNyZWF0ZUNhcmQiLCJpdGVtIiwibGlrZSIsInNob3ciLCJjYXJkIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZSIsInNyYyIsImxpbmsiLCJhbHQiLCJuYW1lIiwidGV4dENvbnRlbnQiLCJsaWtlcyIsImxlbmd0aCIsImRlbGV0ZUNhcmQiLCJldnQiLCJjbG9zZXN0IiwicHJlc3NMaWtlIiwidG9nZ2xlIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsInZhbGlkYXRpb25Db25maWciLCJlcnJvckVsZW1lbnQiLCJjb25jYXQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsImNsZWFyVmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiZm9yRWFjaCIsImNvbmZpZyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInBvcHVwVHlwZUVkaXQiLCJwb3B1cFR5cGVOZXdDYXJkIiwicG9wdXBUeXBlSW1hZ2UiLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJwb3B1cEltYWdlIiwicG9wdXBJbWFnZUNhcHRpb24iLCJmb3JtQWRkTmV3UHJvZmlsZSIsImZvcm1zIiwibmFtZUlucHV0UHJvZmlsZSIsImRlc2NyaXB0aW9uSW5wdXRQcm9maWxlIiwiZm9ybUFkZE5ld0NhcmQiLCJuYW1lSW5wdXRQbHVzIiwiZGVzY3JpcHRpb25JbnB1dFBsdXMiLCJjYXJkUGxhY2VMaXN0Iiwic2hvd0NhcmQiLCJpbnB1dE5hbWUiLCJpbnB1dERlc2NyaXB0aW9uIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsInRoZW4iLCJyZXN1bHQiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyZXNldCIsImRhdGEiLCJuZXdDYXJkIiwibmV3QWRkQ2FyZCIsInByZXBlbmQiLCJhbGwiLCJfcmVmIiwiX3JlZjIiLCJjYXJkcyIsInVzZXJEYXRhIiwiYXBwZW5kIiwiZm9ybVNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJwYXR0ZXJuTWlzbWF0Y2giLCJzZXRDdXN0b21WYWxpZGl0eSIsImRhdGFzZXQiLCJlcnJvck1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlbmFibGVWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==