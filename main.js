(()=>{"use strict";function e(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",t),e.addEventListener("click",n)}function t(e){"Escape"===e.key&&r(document.querySelector(".popup_is-opened"))}function n(e){(e.currentTarget===e.target||e.target.classList.contains("popup__close"))&&r(e.currentTarget)}function r(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",t),e.removeEventListener("click",n)}function o(e,t,n,r,o){var c=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0);c.id=e._id;var a=c.querySelector(".card__image");a.src=e.link,a.alt=e.name;var u=c.querySelector(".card__delete-button");c.querySelector(".card__description").querySelector(".card__title").textContent=e.name;var i=e.likes,s=c.querySelector(".card__counter"),l=c.querySelector(".card__like-button");function d(){c.remove()}e.owner._id!==o&&(u.style.visibility="hidden");var p=function(){return i.some((function(e){return e._id===o}))},f=function(e){i=e,m()},m=function(){p()?l.classList.add("card__like-button_is-active"):l.classList.remove("card__like-button_is-active"),s.textContent=i.length};return m(),l.addEventListener("click",(function(){return t(e._id,p(),f)})),u.addEventListener("click",(function(){return n(e._id,d)})),a.addEventListener("click",(function(){return r(e)})),c}var c=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""},a=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled=!0)},u=function(e,t){Array.from(e.querySelectorAll(t.inputSelector)).forEach((function(t,n){c(e,t,n)}))},i={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"bb1fee31-957c-4b3e-9d5c-e5a39df6a8a4","Content-Type":"application/json"}};function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=document.querySelector(".popup_type_edit");l.classList.add("popup_is-animated");var d=document.querySelector(".popup_type_new-card");d.classList.add("popup_is-animated");var p=document.querySelector(".popup_type_avatar");p.classList.add("popup_is-animated");var f=document.querySelector(".popup_type_image");f.classList.add("popup_is-animated");var m=document.querySelector(".profile__title"),_=document.querySelector(".profile__description"),v=document.querySelector(".profile__avatar"),y=document.querySelector(".profile__edit-button"),h=document.querySelector(".profile__add-button"),b=document.querySelector(".profile__avatar-button"),S=document.querySelector(".popup__image"),q=document.querySelector(".popup__caption"),g="",E="",L=document.forms["edit-profile"],k=document.querySelector(".popup__input_type_name"),C=document.querySelector(".popup__input_type_description"),j=document.forms["new-place"],A=document.querySelector(".popup__input_type_card-name"),x=document.querySelector(".popup__input_type_url"),P=document.forms["edit-avatar"],T=document.querySelector(".popup__input_type_avatar"),w=document.querySelector(".places__list"),U={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function O(e,t){e.textContent=t}function B(e,t,n){(function(e,t){return fetch("".concat(i.baseUrl,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))})(e,t).then((function(e){n(e.likes)})).catch((function(e){console.log(e)}))}function D(e,t){var n;(n=e,fetch("".concat(i.baseUrl,"/cards/").concat(n),{method:"DELETE",headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){t(e)})).catch((function(e){console.log(e)}))}function I(t){S.src=t.link,S.alt=t.name,q.textContent=t.name,e(f)}Promise.all([fetch("".concat(i.baseUrl,"/cards"),{method:"GET",headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),fetch("".concat(i.baseUrl,"/users/me"),{method:"GET",headers:i.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,u=[],i=!0,s=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=c.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(t,n)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=r[0],a=r[1];g=a.avatar,E=a._id,m.textContent=a.name,_.textContent=a.about,v.style.backgroundImage="url(".concat(a.avatar,")"),c.forEach((function(e){w.append(o(e,B,D,I,E))}))})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);a(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?c(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,o,t),a(n,r,t)}))}))}(t,e)}))}(U),L.addEventListener("submit",(function(e){var t,n;O(e.submitter,"Сохранение..."),e.preventDefault(),(t=k.value,n=C.value,fetch("".concat(i.baseUrl,"/users/me"),{method:"PATCH",headers:i.headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(t){m.textContent=t.name,_.textContent=t.about,e.target.reset(),r(l)})).catch((function(e){console.log(e)}))})),j.addEventListener("submit",(function(e){var t;O(e.submitter,"Сохранение..."),e.preventDefault(),(t={name:A.value,link:x.value},fetch("".concat(i.baseUrl,"/cards"),{method:"POST",headers:i.headers,body:JSON.stringify(t)}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(t){var n=o(t,B,D,I,E);A.value="",x.value="",w.prepend(n),e.target.reset(),r(d)})).catch((function(e){console.log(e)}))})),P.addEventListener("submit",(function(e){var t;O(e.submitter,"Сохранение..."),e.preventDefault(),(t={avatar:T.value},fetch("".concat(i.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:i.headers,body:JSON.stringify(t)}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){v.style="background-image: url(".concat(e.avatar,")"),g=e.avatar,r(p)})).catch((function(e){console.log(e)}))})),y.addEventListener("click",(function(){e(l),k.value=m.textContent,C.value=_.textContent,u(l,U)})),h.addEventListener("click",(function(){e(d),u(d,U)})),b.addEventListener("click",(function(){u(p,U),e(p),T.value=g}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFvQixDQUNoRGlDLE9BQVEsUUFDUmhDLFFBQVNGLEVBQU9FLFFBQ2hCc0UsS0FBTUMsS0FBS0MsVUFBVS9CLEtBR3RCUixNQUFLLFNBQUNDLEdBQ0wsT0FBSUEsRUFBT0MsR0FDRkQsRUFBT0UsT0FFUEMsUUFBUUMsT0FBTyxXQUFEekQsT0FBWXFELEVBQU9LLFFBRTVDLEtDaEJDTixNQUFLLFNBQUNRLEdBQ0xqQyxFQUFjekMsTUFBUSx5QkFBSGMsT0FBNEI0RCxFQUFLVSxPQUFNLEtBQzFEckMsRUFBYTJCLEVBQUtVLE9BQ2xCbEgsRUFBV21FLEVBQ2IsSUFDQ3NDLE9BQU0sU0FBQ0MsR0FDTkMsUUFBUUMsSUFBSUYsRUFDZCxHQUNGLElBcUVBbEMsRUFBa0I3RSxpQkFBaUIsU0F4Q25DLFdBQ0VMLEVBQVUyRSxHQUNWZSxFQUFpQm9ELE1BQVEvRCxFQUFhN0MsWUFDdEN5RCxFQUF3Qm1ELE1BQVM5RCxFQUFtQjlDLFlBQ3BEK0IsRUFBZ0JVLEVBQWV2QixFQUNqQyxJQW9DQStCLEVBQWlCOUUsaUJBQWlCLFNBbENsQyxXQUNFTCxFQUFVNEUsR0FDVlgsRUFBZ0JXLEVBQWtCeEIsRUFDcEMsSUFnQ0FnQyxFQUFvQi9FLGlCQUFpQixTQTlCckMsV0FDRTRELEVBQWdCWSxFQUFpQnpCLEdBQ2pDcEQsRUFBVTZFLEdBQ1ZtQixFQUFnQjhDLE1BQVF2RCxDQUMxQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veWFuZGV4LXByYWt0aWt1bS8uL3NyYy9jb21wb25lbnRzL21vZGFscy5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvY2FyZC5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly95YW5kZXgtcHJha3Rpa3VtLy4vc3JjL2NvbXBvbmVudHMvYXBpLmpzIiwid2VicGFjazovL3lhbmRleC1wcmFrdGlrdW0vLi9zcmMvY29tcG9uZW50cy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBvcGVuUG9wdXAocG9wdXApIHtcclxuICBwb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfaXMtb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlRXNjUG9wdXApO1xyXG4gIHBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDbG9zZU1vZGFsV2luZG93T3ZlcmxheUNsaWNrKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VFc2NQb3B1cChldmVudCkge1xyXG4gIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNsb3NlUG9wdXAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2lzLW9wZW5lZCcpKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNsb3NlTW9kYWxXaW5kb3dPdmVybGF5Q2xpY2soZXZlbnQpIHtcclxuICBpZiAoZXZlbnQuY3VycmVudFRhcmdldCA9PT0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZScpKSB7XHJcbiAgICBjbG9zZVBvcHVwKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VQb3B1cChwb3B1cCkge1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2lzLW9wZW5lZCcpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlRXNjUG9wdXApO1xyXG4gIHBvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDbG9zZU1vZGFsV2luZG93T3ZlcmxheUNsaWNrKTtcclxufVxyXG5cclxuZXhwb3J0IHtvcGVuUG9wdXAsIGNsb3NlUG9wdXB9OyIsIi8vINCk0YPQvdC60YbQuNGPINGB0L7Qt9C00LDQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuCAvL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtLCBwcmVzc0xpa2UsIGRlbGV0ZUNhcmRzLCBzaG93Q2FyZCwgdXNlcklkKSB7XHJcbiAgLy8g0KLQtdC80L/Qu9C10LnRgiDQutCw0YDRgtC+0YfQutC4IC8vXHJcbiAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NhcmQtdGVtcGxhdGUnKS5jb250ZW50O1xyXG5cclxuICBjb25zdCBjYXJkID0gY2FyZFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJykuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNhcmQuaWQgPSBpdGVtLl9pZDtcclxuICBcclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xyXG4gIGNhcmRJbWFnZS5zcmMgPSBpdGVtLmxpbms7XHJcbiAgY2FyZEltYWdlLmFsdCA9IGl0ZW0ubmFtZTtcclxuICAvLyBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IHNob3cgKGl0ZW0pIH0pO1xyXG4gIFxyXG4gIGNvbnN0IGNhcmREZWxldGUgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJyk7XHJcbiAgLy8gY2FyZERlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlbW92ZSk7XHJcbiAgXHJcbiAgY29uc3QgY2FyZEZvb3RlckNvbnRhaW5lciA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2Rlc2NyaXB0aW9uJyk7XHJcbiAgLy8gY29uc3QgbGlrZUNvbnRhaW5lciA9IGNhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtY29udGFpbmVyJyk7XHJcbiAgXHJcbiAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEZvb3RlckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcclxuICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSBpdGVtLm5hbWU7XHJcbiAgXHJcbiAgbGV0IGxpa2VzID0gaXRlbS5saWtlcztcclxuXHJcbiAgY29uc3QgY2FyZENvdW50ZXIgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19jb3VudGVyJyk7XHJcbiAgLy8gY2FyZENvdW50ZXIudGV4dENvbnRlbnQgPSBpdGVtLmxpa2VzLmxlbmd0aDtcclxuXHJcbiAgY29uc3QgY2FyZExpa2UgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpO1xyXG4gIC8vIGNhcmRMaWtlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbGlrZSk7XHJcbiAgXHJcbiAgZnVuY3Rpb24gZGVsZXRlQ2FyZCgpIHtcclxuICAgIGNhcmQucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjaGVja0RlbGV0ZUljb24oKSB7XHJcbiAgICBpZiAoaXRlbS5vd25lci5faWQgIT09IHVzZXJJZCkge1xyXG4gICAgICBjYXJkRGVsZXRlLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xyXG4gICAgfVxyXG4gIH1cclxuICBjaGVja0RlbGV0ZUljb24oKTtcclxuXHJcbiAgLy8g0L/RgNC+0LLQtdGA0Y/QtdC8INC70LDQudC60L3Rg9C70Lgg0LvQuCDQvNGLINC60LDRgNGC0L7Rh9C60YNcclxuICBjb25zdCBjaGVja0xpa2UgPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHVzZXJJZCk7XHJcbiAgfTtcclxuICAvLyDQvtCx0L3QvtCy0LvRj9C10YIg0YLQtdC60YPRidC40Lkg0LzQsNGB0YHQuNCyINC70LDQudC60L7QsiDQuCDQvtCx0L3QvtCy0LvRj9C10YIg0YHRgtCw0YLRg9GBXHJcbiAgY29uc3QgY2hhbmdlTGlrZSA9IChuZXdMaWtlcykgPT4ge1xyXG4gICAgbGlrZXMgPSBuZXdMaWtlcztcclxuICAgIHNldExpa2VTdGF0dXMoKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBzZXRMaWtlU3RhdHVzID0gKCkgPT4ge1xyXG4gICAgY29uc3QgaXNMaWtlZCA9IGNoZWNrTGlrZSgpO1xyXG4gICAgaWYgKGlzTGlrZWQpIHtcclxuICAgICAgY2FyZExpa2UuY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjYXJkTGlrZS5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICAgIH1cclxuICAgIGNhcmRDb3VudGVyLnRleHRDb250ZW50ID0gbGlrZXMubGVuZ3RoO1xyXG4gIH07XHJcbiAgc2V0TGlrZVN0YXR1cygpO1xyXG5cclxuICBjYXJkTGlrZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgIHByZXNzTGlrZShpdGVtLl9pZCwgY2hlY2tMaWtlKCksIGNoYW5nZUxpa2UpXHJcbiAgKTtcclxuICBjYXJkRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBcclxuICAgIGRlbGV0ZUNhcmRzKGl0ZW0uX2lkLCBkZWxldGVDYXJkKVxyXG4gICk7XHJcbiAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBcclxuICAgIHNob3dDYXJkKGl0ZW0pXHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIGNhcmQ7XHJcbn0iLCJjb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsaWRhdGlvbkNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodmFsaWRhdGlvbkNvbmZpZy5lcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxufTtcclxuICBcclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yTWVzc2FnZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eShcIlwiKTtcclxuICB9XHJcblxyXG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9XHJcbn07XHJcbiAgXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuICBcclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufVxyXG4gIFxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxufVxyXG4gIFxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfSlcclxufVxyXG4gIFxyXG5jb25zdCBjbGVhclZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9KTtcclxufTtcclxuICBcclxuZXhwb3J0IHtlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb259OyIsImNvbnN0IGNvbmZpZyA9IHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtMicsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogJ2JiMWZlZTMxLTk1N2MtNGIzZS05ZDVjLWU1YTM5ZGY2YThhNCcsXHJcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VXNlckRhdGEgPSAoKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xyXG4gIH0pXHJcbiAgXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgaWYgKHJlc3VsdC5vaykge1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlc3VsdC5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldEluaXRpYWxDYXJkcyA9ICgpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgbWV0aG9kOiAnR0VUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuICBcclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZWRpdE15UHJvZmlsZSA9IChpbnB1dE5hbWUsIGlucHV0RGVzY3JpcHRpb24pID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIG5hbWU6IGlucHV0TmFtZSxcclxuICAgICAgYWJvdXQ6IGlucHV0RGVzY3JpcHRpb25cclxuICAgIH0pXHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgaWYgKHJlc3VsdC5vaykge1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlc3VsdC5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUNhcmROZXcgPSAoZGF0YSkgPT4ge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcclxuICB9KVxyXG5cclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY2xpY2tPbkxpa2UgPSAoaWQsIGlzTGlrZWQpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgbWV0aG9kOiBpc0xpa2VkID8gJ0RFTEVURScgOiAnUFVUJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgaWYgKHJlc3VsdC5vaykge1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlc3VsdC5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZU15Q2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy8ke2RhdGF9YCwge1xyXG4gICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcbiAgfSlcclxuXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgaWYgKHJlc3VsdC5vaykge1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlc3VsdC5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHVwZGF0ZU15QXZhdGFyID0gKGRhdGEpID0+IHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcclxuICB9KVxyXG5cclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICBpZiAocmVzdWx0Lm9rKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHQuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzdWx0LnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9KVxyXG59IiwiaW1wb3J0ICcuLi9wYWdlcy9pbmRleC5jc3MnO1xyXG5pbXBvcnQge29wZW5Qb3B1cCwgY2xvc2VQb3B1cH0gZnJvbSAnLi9tb2RhbHMnO1xyXG5pbXBvcnQge2NyZWF0ZUNhcmR9IGZyb20gJy4vY2FyZCc7XHJcbmltcG9ydCB7ZW5hYmxlVmFsaWRhdGlvbiwgY2xlYXJWYWxpZGF0aW9ufSBmcm9tICcuL3ZhbGlkYXRpb24nO1xyXG5pbXBvcnQge2dldFVzZXJEYXRhLCBnZXRJbml0aWFsQ2FyZHMsIGVkaXRNeVByb2ZpbGUsIGNyZWF0ZUNhcmROZXcsIGNsaWNrT25MaWtlLCBkZWxldGVNeUNhcmQsIHVwZGF0ZU15QXZhdGFyfSBmcm9tICcuL2FwaSc7XHJcblxyXG5jb25zdCBwb3B1cFR5cGVFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdCcpO1xyXG5wb3B1cFR5cGVFZGl0LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9pcy1hbmltYXRlZFwiKTtcclxuY29uc3QgcG9wdXBUeXBlTmV3Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX25ldy1jYXJkJyk7XHJcbnBvcHVwVHlwZU5ld0NhcmQuY2xhc3NMaXN0LmFkZChcInBvcHVwX2lzLWFuaW1hdGVkXCIpO1xyXG5jb25zdCBwb3B1cFR5cGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hdmF0YXInKTtcclxucG9wdXBUeXBlQXZhdGFyLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9pcy1hbmltYXRlZFwiKTtcclxuY29uc3QgcG9wdXBUeXBlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9pbWFnZScpO1xyXG5wb3B1cFR5cGVJbWFnZS5jbGFzc0xpc3QuYWRkKFwicG9wdXBfaXMtYW5pbWF0ZWRcIik7XHJcblxyXG5jb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdGl0bGUnKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyk7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyJyk7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbmNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1idXR0b24nKTtcclxuXHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbmNvbnN0IHBvcHVwSW1hZ2VDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJyk7XHJcblxyXG5sZXQgdXNlckF2YXRhciA9IFwiXCI7XHJcbmxldCB1c2VySWQgPSBcIlwiO1xyXG5cclxuY29uc3QgZm9ybUFkZE5ld1Byb2ZpbGUgPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZVwiXTtcclxuY29uc3QgbmFtZUlucHV0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uJyk7XHJcbmNvbnN0IGZvcm1BZGROZXdDYXJkID0gZG9jdW1lbnQuZm9ybXNbXCJuZXctcGxhY2VcIl07XHJcbmNvbnN0IG5hbWVJbnB1dFBsdXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfY2FyZC1uYW1lJyk7XHJcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXRQbHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX3VybCcpO1xyXG5jb25zdCBmb3JtQWRkTmV3QXZhdGFyID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LWF2YXRhclwiXTtcclxuY29uc3QgbmFtZUlucHV0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2F2YXRhcicpO1xyXG4gIFxyXG5jb25zdCBjYXJkUGxhY2VMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlc19fbGlzdCcpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX2J1dHRvbicsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19idXR0b25fZGlzYWJsZWQnLFxyXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnXHJcbn07XHJcblxyXG5mdW5jdGlvbiByZW5kZXJpbmcoYnV0dG9uU2F2ZSwgY29uZGl0aW9uKSB7XHJcbiAgYnV0dG9uU2F2ZS50ZXh0Q29udGVudCA9IGNvbmRpdGlvbjtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdFByb2ZpbGUoZXZ0KSB7XHJcbiAgXHJcbiAgcmVuZGVyaW5nKGV2dC5zdWJtaXR0ZXIsICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicpO1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBlZGl0TXlQcm9maWxlKFxyXG4gICAgbmFtZUlucHV0UHJvZmlsZS52YWx1ZSxcclxuICAgIGRlc2NyaXB0aW9uSW5wdXRQcm9maWxlLnZhbHVlXHJcbiAgKVxyXG4gIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgIHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudCA9IHJlc3VsdC5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcmVzdWx0LmFib3V0O1xyXG4gICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgY2xvc2VQb3B1cChwb3B1cFR5cGVFZGl0KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVGb3JtU3VibWl0QWRkTmV3Q2FyZChldnQpIHtcclxuXHJcbiAgcmVuZGVyaW5nKGV2dC5zdWJtaXR0ZXIsICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLicpO1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjcmVhdGVDYXJkTmV3KHtcclxuICAgIG5hbWU6IG5hbWVJbnB1dFBsdXMudmFsdWUsXHJcbiAgICBsaW5rOiBkZXNjcmlwdGlvbklucHV0UGx1cy52YWx1ZSxcclxuICB9KVxyXG4gIC50aGVuKChuZXdDYXJkKSA9PiB7XHJcbiAgICBjb25zdCBuZXdBZGRDYXJkID0gY3JlYXRlQ2FyZChuZXdDYXJkLCBwcmVzc0xpa2UsIGRlbGV0ZUNhcmRzLCBzaG93Q2FyZCwgdXNlcklkKTtcclxuICAgIG5hbWVJbnB1dFBsdXMudmFsdWUgPSBcIlwiO1xyXG4gICAgZGVzY3JpcHRpb25JbnB1dFBsdXMudmFsdWUgPSBcIlwiO1xyXG4gICAgY2FyZFBsYWNlTGlzdC5wcmVwZW5kKG5ld0FkZENhcmQpO1xyXG4gICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgY2xvc2VQb3B1cChwb3B1cFR5cGVOZXdDYXJkKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVGb3JtU3VibWl0QXZhdGFyKGV2dCkge1xyXG5cclxuICByZW5kZXJpbmcoZXZ0LnN1Ym1pdHRlciwgJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJyk7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIHVwZGF0ZU15QXZhdGFyKHsgYXZhdGFyOiBuYW1lSW5wdXRBdmF0YXIudmFsdWUgfSlcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgcHJvZmlsZUF2YXRhci5zdHlsZSA9IGBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJHtkYXRhLmF2YXRhcn0pYDtcclxuICAgIHVzZXJBdmF0YXIgPSBkYXRhLmF2YXRhcjtcclxuICAgIGNsb3NlUG9wdXAocG9wdXBUeXBlQXZhdGFyKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBwcmVzc0xpa2UoaWQsIGlzTGlrZWQsIGNoYW5nZUxpa2UpIHtcclxuICBjbGlja09uTGlrZShpZCwgaXNMaWtlZClcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgY2hhbmdlTGlrZShkYXRhLmxpa2VzKVxyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUNhcmRzKGlkLCBkZWxldGVDYXJkKSB7XHJcbiAgZGVsZXRlTXlDYXJkKGlkKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgZGVsZXRlQ2FyZChkYXRhKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93Q2FyZChpdGVtKSB7XHJcbiAgcG9wdXBJbWFnZS5zcmMgPSBpdGVtLmxpbms7XHJcbiAgcG9wdXBJbWFnZS5hbHQgPSBpdGVtLm5hbWU7XHJcbiAgcG9wdXBJbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBpdGVtLm5hbWU7XHJcbiAgb3BlblBvcHVwKHBvcHVwVHlwZUltYWdlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblBvcHVwUHJvZmlsZSgpIHtcclxuICBvcGVuUG9wdXAocG9wdXBUeXBlRWRpdCk7XHJcbiAgbmFtZUlucHV0UHJvZmlsZS52YWx1ZSA9IHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudFxyXG4gIGRlc2NyaXB0aW9uSW5wdXRQcm9maWxlLnZhbHVlID0gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICBjbGVhclZhbGlkYXRpb24ocG9wdXBUeXBlRWRpdCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Qb3B1cEFkZE5ld0NhcmQoKSB7XHJcbiAgb3BlblBvcHVwKHBvcHVwVHlwZU5ld0NhcmQpO1xyXG4gIGNsZWFyVmFsaWRhdGlvbihwb3B1cFR5cGVOZXdDYXJkLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblBvcHVwQXZhdGFyKCkge1xyXG4gIGNsZWFyVmFsaWRhdGlvbihwb3B1cFR5cGVBdmF0YXIsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIG9wZW5Qb3B1cChwb3B1cFR5cGVBdmF0YXIpO1xyXG4gIG5hbWVJbnB1dEF2YXRhci52YWx1ZSA9IHVzZXJBdmF0YXI7XHJcbn1cclxuXHJcblByb21pc2UuYWxsKFtnZXRJbml0aWFsQ2FyZHMoKSwgZ2V0VXNlckRhdGEoKV0pXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlckRhdGFdKSA9PiB7XHJcbiAgICB1c2VyQXZhdGFyID0gdXNlckRhdGEuYXZhdGFyO1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgcHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xyXG4gICAgcHJvZmlsZUF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dXNlckRhdGEuYXZhdGFyfSlgO1xyXG5cclxuICAgIGNhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgY2FyZFBsYWNlTGlzdC5hcHBlbmQoY3JlYXRlQ2FyZChpdGVtLCBwcmVzc0xpa2UsIGRlbGV0ZUNhcmRzLCBzaG93Q2FyZCwgdXNlcklkKSk7XHJcbiAgICB9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KVxyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuXHJcbmZvcm1BZGROZXdQcm9maWxlLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUZvcm1TdWJtaXRQcm9maWxlKTtcclxuZm9ybUFkZE5ld0NhcmQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgaGFuZGxlRm9ybVN1Ym1pdEFkZE5ld0NhcmQpO1xyXG5mb3JtQWRkTmV3QXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUZvcm1TdWJtaXRBdmF0YXIpO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUG9wdXBQcm9maWxlKTtcclxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Qb3B1cEFkZE5ld0NhcmQpO1xyXG5wcm9maWxlQXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblBvcHVwQXZhdGFyKTsiXSwibmFtZXMiOlsib3BlblBvcHVwIiwicG9wdXAiLCJjbGFzc0xpc3QiLCJhZGQiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbG9zZUVzY1BvcHVwIiwiaGFuZGxlQ2xvc2VNb2RhbFdpbmRvd092ZXJsYXlDbGljayIsImV2ZW50Iiwia2V5IiwiY2xvc2VQb3B1cCIsInF1ZXJ5U2VsZWN0b3IiLCJjdXJyZW50VGFyZ2V0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY3JlYXRlQ2FyZCIsIml0ZW0iLCJwcmVzc0xpa2UiLCJkZWxldGVDYXJkcyIsInNob3dDYXJkIiwidXNlcklkIiwiY2FyZCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJpZCIsIl9pZCIsImNhcmRJbWFnZSIsInNyYyIsImxpbmsiLCJhbHQiLCJuYW1lIiwiY2FyZERlbGV0ZSIsInRleHRDb250ZW50IiwibGlrZXMiLCJjYXJkQ291bnRlciIsImNhcmRMaWtlIiwiZGVsZXRlQ2FyZCIsIm93bmVyIiwic3R5bGUiLCJ2aXNpYmlsaXR5IiwiY2hlY2tMaWtlIiwic29tZSIsImxpa2UiLCJjaGFuZ2VMaWtlIiwibmV3TGlrZXMiLCJzZXRMaWtlU3RhdHVzIiwibGVuZ3RoIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsInZhbGlkYXRpb25Db25maWciLCJlcnJvckVsZW1lbnQiLCJjb25jYXQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsImNsZWFyVmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiZm9yRWFjaCIsImNvbmZpZyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInBvcHVwVHlwZUVkaXQiLCJwb3B1cFR5cGVOZXdDYXJkIiwicG9wdXBUeXBlQXZhdGFyIiwicG9wdXBUeXBlSW1hZ2UiLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQWRkQnV0dG9uIiwicHJvZmlsZUF2YXRhckJ1dHRvbiIsInBvcHVwSW1hZ2UiLCJwb3B1cEltYWdlQ2FwdGlvbiIsInVzZXJBdmF0YXIiLCJmb3JtQWRkTmV3UHJvZmlsZSIsImZvcm1zIiwibmFtZUlucHV0UHJvZmlsZSIsImRlc2NyaXB0aW9uSW5wdXRQcm9maWxlIiwiZm9ybUFkZE5ld0NhcmQiLCJuYW1lSW5wdXRQbHVzIiwiZGVzY3JpcHRpb25JbnB1dFBsdXMiLCJmb3JtQWRkTmV3QXZhdGFyIiwibmFtZUlucHV0QXZhdGFyIiwiY2FyZFBsYWNlTGlzdCIsImZvcm1TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwicmVuZGVyaW5nIiwiYnV0dG9uU2F2ZSIsImNvbmRpdGlvbiIsImlzTGlrZWQiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJyZXN1bHQiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2xpY2tPbkxpa2UiLCJkYXRhIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJhbGwiLCJfcmVmIiwiX3JlZjIiLCJjYXJkcyIsInVzZXJEYXRhIiwiYXZhdGFyIiwiYWJvdXQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJhcHBlbmQiLCJwYXR0ZXJuTWlzbWF0Y2giLCJzZXRDdXN0b21WYWxpZGl0eSIsImRhdGFzZXQiLCJlcnJvck1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwiaW5wdXROYW1lIiwiaW5wdXREZXNjcmlwdGlvbiIsInN1Ym1pdHRlciIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc2V0IiwibmV3Q2FyZCIsIm5ld0FkZENhcmQiLCJwcmVwZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==